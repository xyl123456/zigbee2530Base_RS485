///////////////////////////////////////////////////////////////////////////////
//                                                                            /
// IAR C/C++ Compiler V8.10.1.10194/W32 for 8051        25/Nov/2016  10:13:17 /
// Copyright 2004-2011 IAR Systems AB.                                        /
//                                                                            /
//    Core               =  plain                                             /
//    Code model         =  banked                                            /
//    Data model         =  large                                             /
//    Calling convention =  xdata reentrant                                   /
//    Constant location  =  data_rom                                          /
//    Dptr setup         =  1,16                                              /
//    Source file        =  E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\Source\Device\ConnectorAp /
//                          p.c                                               /
//    Command line       =  -f E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zs /
//                          tack\Applications\SmartApp\CC2530DB\Devices\..\.. /
//                          \..\..\Tools\CC2530DB\f8wCoord.cfg (-DCPU32MHZ    /
//                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TR /
//                          UE -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8     /
//                          -DMAC_CFG_RX_MAX=5 -DZDO_COORDINATOR -DRTR_NWK    /
//                          -DSSA_CONNECTOR) -f E:\work\zigbee\ZStack-Smart-2 /
//                          .5.2b\Projects\zstack\Applications\SmartApp\CC253 /
//                          0DB\Devices\..\..\..\..\Tools\CC2530DB\f8wConfig. /
//                          cfg (-DZIGBEEPRO -DSECURE=1                       /
//                          -DZG_SECURE_DYNAMIC=1 -DREFLECTOR                 /
//                          -DDEFAULT_CHANLIST=0x00000800                     /
//                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                      /
//                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_M /
//                          ASK=0x007F -DBEACON_REQUEST_DELAY=100             /
//                          -DBEACON_REQ_DELAY_MASK=0x00FF                    /
//                          -DLINK_STATUS_JITTER_MASK=0x007F                  /
//                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_P /
//                          OLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7           /
//                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3   /
//                          -DNWK_MAX_DATA_RETRIES=2                          /
//                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9        /
//                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40          /
//                          -DNWK_MAX_BINDING_ENTRIES=4                       /
//                          -DMAX_BINDING_CLUSTER_IDS=4                       /
//                          "-DDEFAULT_KEY={0x01, 0x03, 0x05, 0x07, 0x09,     /
//                          0x0B, 0x0D, 0x0F, 0x00, 0x02, 0x04, 0x06, 0x08,   /
//                          0x0A, 0x0C, 0x0D}" -DMAC_MAX_FRAME_SIZE=116       /
//                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const    /
//                          __code" -DGENERIC=__generic                       /
//                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=600        /
//                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)  /
//                          -DREJOIN_POLL_RATE=440 E:\work\zigbee\ZStack-Smar /
//                          t-2.5.2b\Projects\zstack\Applications\SmartApp\So /
//                          urce\Device\ConnectorApp.c -D SECURE=1 -D         /
//                          ZTOOL_P1 -D DEVICE_TYPE_ID=0xFE -D                /
//                          SIGNAL_AMPLIFIER_SETTING -D                       /
//                          xPOWER_AMPLIFIER_POSITION_1 -D xNWK_AUTO_POLL -D  /
//                          xHAL_UART_DMA=2 -D xHAL_UART_DMA_ALT1 -D          /
//                          xJIAJU_BUILDIN -D MT_TASK -D MT_SYS_FUNC -D       /
//                          MT_ZDO_FUNC -D NV_INIT -D NV_RESTORE -lC          /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\bin\DemoBaseZC\L /
//                          ist\ -lA E:\work\zigbee\ZStack-Smart-2.5.2b\Proje /
//                          cts\zstack\Applications\SmartApp\CC2530DB\bin\Dem /
//                          oBaseZC\List\ --diag_suppress Pe001,Pa010 -o      /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\bin\DemoBaseZC\O /
//                          bj\ -e --debug --core=plain --dptr=16,1           /
//                          --data_model=large --code_model=banked            /
//                          --calling_convention=xdata_reentrant              /
//                          --place_constants=data_rom --nr_virtual_regs 16   /
//                          -I E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zs /
//                          tack\Applications\SmartApp\CC2530DB\Devices\ -I   /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\So /
//                          urce\Common\ -I E:\work\zigbee\ZStack-Smart-2.5.2 /
//                          b\Projects\zstack\Applications\SmartApp\CC2530DB\ /
//                          Devices\..\..\Source\Connector\ -I                /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\So /
//                          urce\\EndNode\ -I E:\work\zigbee\ZStack-Smart-2.5 /
//                          .2b\Projects\zstack\Applications\SmartApp\CC2530D /
//                          B\Devices\..\..\Source\Board\ -I                  /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\So /
//                          urce\Manage\ -I E:\work\zigbee\ZStack-Smart-2.5.2 /
//                          b\Projects\zstack\Applications\SmartApp\CC2530DB\ /
//                          Devices\..\..\Source\Manage\Callbacks\ -I         /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\So /
//                          urce\Manage\debug\ -I E:\work\zigbee\ZStack-Smart /
//                          -2.5.2b\Projects\zstack\Applications\SmartApp\CC2 /
//                          530DB\Devices\..\..\Source\Manage\HeartBeat\ -I   /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\So /
//                          urce\Manage\incode\ -I E:\work\zigbee\ZStack-Smar /
//                          t-2.5.2b\Projects\zstack\Applications\SmartApp\CC /
//                          2530DB\Devices\..\..\..\..\ZMain\TI2530DB\ -I     /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\hal\include\ -I              /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\hal\target\CC2530EB\ -I      /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\mac\include\ -I              /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\mac\high_level\ -I           /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\mac\low_level\srf04\ -I      /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\mac\low_level\srf04\single_c /
//                          hip\ -I E:\work\zigbee\ZStack-Smart-2.5.2b\Projec /
//                          ts\zstack\Applications\SmartApp\CC2530DB\Devices\ /
//                          ..\..\..\..\..\..\Components\mt\ -I               /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\osal\include\ -I             /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\services\saddr\ -I           /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\services\sdata\ -I           /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\stack\af\ -I                 /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\stack\nwk\ -I                /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\stack\sapi\ -I               /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\stack\sec\ -I                /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\stack\sys\ -I                /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\stack\zdo\ -I                /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\zmac\ -I                     /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\zmac\f8w\ -Oh                /
//                          --require_prototypes                              /
//    List file          =  E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\bin\DemoBaseZC\L /
//                          ist\ConnectorApp.s51                              /
//                                                                            /
//                                                                            /
///////////////////////////////////////////////////////////////////////////////

        NAME ConnectorApp

        RTMODEL "__SystemLibrary", "CLib"
        RTMODEL "__calling_convention", "xdata_reentrant"
        RTMODEL "__code_model", "banked"
        RTMODEL "__core", "plain"
        RTMODEL "__data_model", "large"
        RTMODEL "__dptr_size", "16"
        RTMODEL "__extended_stack", "disabled"
        RTMODEL "__location_for_constants", "data"
        RTMODEL "__number_of_dptrs", "1"
        RTMODEL "__rt_version", "1"

        RSEG DOVERLAY:DATA:NOROOT(0)
        RSEG IOVERLAY:IDATA:NOROOT(0)
        RSEG ISTACK:IDATA:NOROOT(0)
        RSEG PSTACK:XDATA:NOROOT(0)
        RSEG XSTACK:XDATA:NOROOT(0)

        EXTERN ?BANKED_ENTER_XDATA
        EXTERN ?BANKED_LEAVE_XDATA
        EXTERN ?BDISPATCH
        EXTERN ?BRET
        EXTERN ?V0
        EXTERN __INIT_XDATA_Z

        PUBLIC ??CommonApp_HandleCombineKeys?relay
        FUNCTION ??CommonApp_HandleCombineKeys?relay,0203H
        PUBLIC ??CommonApp_InitConfirm?relay
        FUNCTION ??CommonApp_InitConfirm?relay,0203H
        PUBLIC ??CommonApp_MessageMSGCB?relay
        FUNCTION ??CommonApp_MessageMSGCB?relay,0203H
        PUBLIC ??CommonApp_ProcessZDOStates?relay
        FUNCTION ??CommonApp_ProcessZDOStates?relay,0203H
        PUBLIC ??CommonApp_RS485SendMessage?relay
        FUNCTION ??CommonApp_RS485SendMessage?relay,0203H
        PUBLIC ??ConnectorApp_TxHandler?relay
        FUNCTION ??ConnectorApp_TxHandler?relay,0203H
        PUBLIC CommonApp_HandleCombineKeys
        FUNCTION CommonApp_HandleCombineKeys,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        PUBLIC CommonApp_InitConfirm
        FUNCTION CommonApp_InitConfirm,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        PUBLIC CommonApp_MessageMSGCB
        FUNCTION CommonApp_MessageMSGCB,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        PUBLIC CommonApp_ProcessZDOStates
        FUNCTION CommonApp_ProcessZDOStates,0203H
        ARGFRAME XSTACK, 0, STACK
        PUBLIC CommonApp_RS485SendMessage
        FUNCTION CommonApp_RS485SendMessage,021203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 12, STACK
        PUBLIC ConnectorApp_TxHandler
        FUNCTION ConnectorApp_TxHandler,021603H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        PUBWEAK WDCTL
        PUBLIC list_len
        
        CFI Names cfiNames0
        CFI StackFrame CFA_SP SP IDATA
        CFI StackFrame CFA_PSP16 PSP16 XDATA
        CFI StackFrame CFA_XSP16 XSP16 XDATA
        CFI StaticOverlayFrame CFA_IOVERLAY IOVERLAY
        CFI StaticOverlayFrame CFA_DOVERLAY DOVERLAY
        CFI Resource `PSW.CY`:1, `B.BR0`:1, `B.BR1`:1, `B.BR2`:1, `B.BR3`:1
        CFI Resource `B.BR4`:1, `B.BR5`:1, `B.BR6`:1, `B.BR7`:1, `VB.BR8`:1
        CFI Resource `VB.BR9`:1, `VB.BR10`:1, `VB.BR11`:1, `VB.BR12`:1
        CFI Resource `VB.BR13`:1, `VB.BR14`:1, `VB.BR15`:1, VB:8, B:8, A:8
        CFI Resource PSW:8, DPL0:8, DPH0:8, R0:8, R1:8, R2:8, R3:8, R4:8, R5:8
        CFI Resource R6:8, R7:8, V0:8, V1:8, V2:8, V3:8, V4:8, V5:8, V6:8, V7:8
        CFI Resource V8:8, V9:8, V10:8, V11:8, V12:8, V13:8, V14:8, V15:8, SP:8
        CFI Resource PSPH:8, PSPL:8, PSP16:16, XSPH:8, XSPL:8, XSP16:16
        CFI VirtualResource ?RET:24
        CFI Resource ?BRET_EXT:8
        CFI VirtualResource ?RET_HIGH:8, ?RET_LOW:8
        CFI ResourceParts PSP16 PSPH, PSPL
        CFI ResourceParts XSP16 XSPH, XSPL
        CFI ResourceParts ?RET ?BRET_EXT, ?RET_HIGH, ?RET_LOW
        CFI EndNames cfiNames0
        
        CFI Common cfiCommon0 Using cfiNames0
        CFI CodeAlign 1
        CFI DataAlign -1
        CFI ReturnAddress ?RET CODE
        CFI CFA_DOVERLAY Used
        CFI CFA_IOVERLAY Used
        CFI CFA_SP SP+-3
        CFI CFA_PSP16 PSP16+0
        CFI CFA_XSP16 XSP16+0
        CFI `PSW.CY` SameValue
        CFI `B.BR0` SameValue
        CFI `B.BR1` SameValue
        CFI `B.BR2` SameValue
        CFI `B.BR3` SameValue
        CFI `B.BR4` SameValue
        CFI `B.BR5` SameValue
        CFI `B.BR6` SameValue
        CFI `B.BR7` SameValue
        CFI `VB.BR8` SameValue
        CFI `VB.BR9` SameValue
        CFI `VB.BR10` SameValue
        CFI `VB.BR11` SameValue
        CFI `VB.BR12` SameValue
        CFI `VB.BR13` SameValue
        CFI `VB.BR14` SameValue
        CFI `VB.BR15` SameValue
        CFI VB SameValue
        CFI B Undefined
        CFI A Undefined
        CFI PSW SameValue
        CFI DPL0 SameValue
        CFI DPH0 SameValue
        CFI R0 Undefined
        CFI R1 Undefined
        CFI R2 Undefined
        CFI R3 Undefined
        CFI R4 Undefined
        CFI R5 Undefined
        CFI R6 SameValue
        CFI R7 SameValue
        CFI V0 SameValue
        CFI V1 SameValue
        CFI V2 SameValue
        CFI V3 SameValue
        CFI V4 SameValue
        CFI V5 SameValue
        CFI V6 SameValue
        CFI V7 SameValue
        CFI V8 SameValue
        CFI V9 SameValue
        CFI V10 SameValue
        CFI V11 SameValue
        CFI V12 SameValue
        CFI V13 SameValue
        CFI V14 SameValue
        CFI V15 SameValue
        CFI PSPH Undefined
        CFI PSPL Undefined
        CFI XSPH Undefined
        CFI XSPL Undefined
        CFI ?RET Concat
        CFI ?BRET_EXT Frame(CFA_SP, 3)
        CFI ?RET_HIGH Frame(CFA_SP, 2)
        CFI ?RET_LOW Frame(CFA_SP, 1)
        CFI EndCommon cfiCommon0
        
CommonApp_PermitJoiningRequest SYMBOL "CommonApp_PermitJoiningRequest"
createNodelist      SYMBOL "createNodelist"
SerialTx_Handler    SYMBOL "SerialTx_Handler"
RS485_GetDevDataSend SYMBOL "RS485_GetDevDataSend"
HalLedBlink         SYMBOL "HalLedBlink"
zgWriteStartupOptions SYMBOL "zgWriteStartupOptions"
ZDOInitDevice       SYMBOL "ZDOInitDevice"
CommonApp_SendTheMessage SYMBOL "CommonApp_SendTheMessage"
get_NodeList        SYMBOL "get_NodeList"
??CommonApp_PermitJoiningRequest?relay SYMBOL "?relay", CommonApp_PermitJoiningRequest
??CommonApp_SendTheMessage?relay SYMBOL "?relay", CommonApp_SendTheMessage
??HalLedBlink?relay SYMBOL "?relay", HalLedBlink
??RS485_GetDevDataSend?relay SYMBOL "?relay", RS485_GetDevDataSend
??SerialTx_Handler?relay SYMBOL "?relay", SerialTx_Handler
??ZDOInitDevice?relay SYMBOL "?relay", ZDOInitDevice
??createNodelist?relay SYMBOL "?relay", createNodelist
??get_NodeList?relay SYMBOL "?relay", get_NodeList
??zgWriteStartupOptions?relay SYMBOL "?relay", zgWriteStartupOptions
CommonApp_HandleCombineKeys SYMBOL "CommonApp_HandleCombineKeys"
??CommonApp_HandleCombineKeys?relay SYMBOL "?relay", CommonApp_HandleCombineKeys
CommonApp_InitConfirm SYMBOL "CommonApp_InitConfirm"
??CommonApp_InitConfirm?relay SYMBOL "?relay", CommonApp_InitConfirm
CommonApp_MessageMSGCB SYMBOL "CommonApp_MessageMSGCB"
??CommonApp_MessageMSGCB?relay SYMBOL "?relay", CommonApp_MessageMSGCB
CommonApp_ProcessZDOStates SYMBOL "CommonApp_ProcessZDOStates"
??CommonApp_ProcessZDOStates?relay SYMBOL "?relay", CommonApp_ProcessZDOStates
CommonApp_RS485SendMessage SYMBOL "CommonApp_RS485SendMessage"
??CommonApp_RS485SendMessage?relay SYMBOL "?relay", CommonApp_RS485SendMessage
ConnectorApp_TxHandler SYMBOL "ConnectorApp_TxHandler"
??ConnectorApp_TxHandler?relay SYMBOL "?relay", ConnectorApp_TxHandler

        EXTERN CommonApp_PermitJoiningRequest
        FUNCTION CommonApp_PermitJoiningRequest,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN createNodelist
        FUNCTION createNodelist,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN SerialTx_Handler
        FUNCTION SerialTx_Handler,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN RS485_GetDevDataSend
        FUNCTION RS485_GetDevDataSend,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN HalLedBlink
        FUNCTION HalLedBlink,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zgWriteStartupOptions
        FUNCTION zgWriteStartupOptions,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN ZDOInitDevice
        FUNCTION ZDOInitDevice,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN CommonApp_SendTheMessage
        FUNCTION CommonApp_SendTheMessage,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN get_NodeList
        FUNCTION get_NodeList,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN ??CommonApp_PermitJoiningRequest?relay
        FUNCTION ??CommonApp_PermitJoiningRequest?relay,00H
        EXTERN ??CommonApp_SendTheMessage?relay
        FUNCTION ??CommonApp_SendTheMessage?relay,00H
        EXTERN ??HalLedBlink?relay
        FUNCTION ??HalLedBlink?relay,00H
        EXTERN ??RS485_GetDevDataSend?relay
        FUNCTION ??RS485_GetDevDataSend?relay,00H
        EXTERN ??SerialTx_Handler?relay
        FUNCTION ??SerialTx_Handler?relay,00H
        EXTERN ??ZDOInitDevice?relay
        FUNCTION ??ZDOInitDevice?relay,00H
        EXTERN ??createNodelist?relay
        FUNCTION ??createNodelist?relay,00H
        EXTERN ??get_NodeList?relay
        FUNCTION ??get_NodeList?relay,00H
        EXTERN ??zgWriteStartupOptions?relay
        FUNCTION ??zgWriteStartupOptions?relay,00H
        EXTERN devState
        EXTERN isPermitJoining

// E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack\Applications\SmartApp\Source\Device\ConnectorApp.c
//    1 /**************************************************************************************************
//    2   Filename:       ConnectorApp.c
//    3   Revised:        $Date: 2014-04-16 13:53:12 -0800 (Wed, 16 Apr 2014) $
//    4   Revision:       $Revision: 29217 $
//    5 
//    6   Description:    Connector Application
//    7 **************************************************************************************************/
//    8 
//    9 /**************************************************************************************************
//   10 Modify by Sam_Chen
//   11 Date:2015-08-07
//   12 **************************************************************************************************/
//   13 
//   14 
//   15 /*********************************************************************
//   16  * INCLUDES
//   17  */
//   18 #include "OSAL.h"
//   19 #include "AF.h"
//   20 #include "ZDApp.h"
//   21 #include "ZDObject.h"
//   22 #include "ZDProfile.h"
//   23 #include "OSAL_Nv.h"
//   24 #include "ZComDef.h"
//   25 #include "OnBoard.h"

        ASEGN SFR_AN:DATA:NOROOT,0c9H
// unsigned char volatile __sfr WDCTL
WDCTL:
        DATA8
        DS 1
//   26 
//   27 #include "CommonApp.h"
//   28 
//   29 /* HAL */
//   30 #include "hal_lcd.h"
//   31 #include "hal_led.h"
//   32 #include "hal_key.h"
//   33 #include "hal_uart.h"
//   34 
//   35 
//   36 /*********************************************************************
//   37  * MACROS
//   38  */
//   39 
//   40 /*********************************************************************
//   41  * CONSTANTS
//   42  */
//   43 
//   44 /*********************************************************************
//   45  * TYPEDEFS
//   46  */
//   47 
//   48 /*********************************************************************
//   49  * GLOBAL VARIABLES
//   50  */
//   51 
//   52 /*********************************************************************
//   53  * EXTERNAL VARIABLES
//   54  */
//   55 extern const cId_t CommonApp_InClusterList[];
//   56 extern const cId_t CommonApp_OutClusterList[];
//   57 extern const SimpleDescriptionFormat_t CommonApp_SimpleDesc;
//   58 
//   59 extern endPointDesc_t CommonApp_epDesc;
//   60 
//   61 extern byte CommonApp_TaskID;
//   62 extern devStates_t CommonApp_NwkState;
//   63 extern byte CommonApp_TransID;
//   64 
//   65 extern afAddrType_t CommonApp_DstAddr;
//   66 
//   67 //network address
//   68 extern uint16 nwkAddr;
//   69 //mac address
//   70 extern ZLongAddr_t macAddr;
//   71 
//   72 extern uint8 SHORT_ADDR_G[4];
//   73 
//   74 extern uint8 EXT_ADDR_G[16];
//   75 
//   76 extern const uint8 f_tail[4];
//   77 
//   78 extern bool isPermitJoining;
//   79 
//   80 /*********************************************************************
//   81  * LOCAL VARIABLES
//   82  */
//   83 static uint8 *fBuf;		//pointer data buffer
//   84 static uint16 fLen;		//buffer data length
//   85 

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//   86 uint8 list_len=0;               //定义list的长度
list_len:
        DS 1
        REQUIRE __INIT_XDATA_Z
//   87 
//   88 /*********************************************************************
//   89  * EXTERNAL FUNCTIONS
//   90  */
//   91 
//   92 /*********************************************************************
//   93  * LOCAL FUNCTIONS
//   94  */
//   95 #ifndef ZDO_COORDINATOR
//   96 static void ConnectorApp_HeartBeatEvent(void);
//   97 #endif
//   98 
//   99 /*********************************************************************
//  100  * NETWORK LAYER CALLBACKS
//  101  */
//  102 
//  103 /*********************************************************************
//  104  * PUBLIC FUNCTIONS
//  105  */
//  106 
//  107 /*********************************************************************
//  108  * @fn      CommonApp_InitConfirm
//  109  *
//  110  * @brief   Initialization function for the Connector App Task.
//  111  *          This is called during initialization and should contain
//  112  *          any application specific initialization (ie. hardware
//  113  *          initialization/setup, table initialization, power up
//  114  *          notificaiton ... ).
//  115  *
//  116  * @param   task_id - the ID assigned by OSAL.  This ID should be
//  117  *                    used to send messages and set timers.
//  118  *
//  119  * @return  none
//  120  */
//  121 

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  122 void CommonApp_InitConfirm( uint8 task_id )
CommonApp_InitConfirm:
        CFI Block cfiBlock0 Using cfiCommon0
        CFI Function CommonApp_InitConfirm
        CODE
//  123 {
        FUNCALL CommonApp_InitConfirm, CommonApp_PermitJoiningRequest
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_InitConfirm, createNodelist
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_InitConfirm, SerialTx_Handler
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
        CFI DPL0 Frame(CFA_SP, 4)
        CFI CFA_SP SP+-4
        PUSH    DPH
        CFI DPH0 Frame(CFA_SP, 5)
        CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
//  124   CommonApp_PermitJoiningRequest(PERMIT_JOIN_FORBID);
        ; Setup parameters for call to function CommonApp_PermitJoiningRequest
        MOV     R1,#0x0
        LCALL   ??CommonApp_PermitJoiningRequest?relay
//  125 #ifdef RS485_DEV
//  126   //初始化LIST,分配NV空间
//  127   createNodelist();
        ; Setup parameters for call to function createNodelist
        LCALL   ??createNodelist?relay
//  128 #endif 
//  129 #if(HAL_UART==TRUE)
//  130   SerialTx_Handler(SERIAL_COM_PORT, ConnectorApp_TxHandler);
        ; Setup parameters for call to function SerialTx_Handler
        MOV     R4,#??ConnectorApp_TxHandler?relay & 0xff
        MOV     R5,#(??ConnectorApp_TxHandler?relay >> 8) & 0xff
        MOV     R2,#0x0
        MOV     R3,#0x0
        LCALL   ??SerialTx_Handler?relay
        CFI EndBlock cfiBlock0
//  131 #endif
//  132 }
        REQUIRE ?Subroutine0
        ; // Fall through to label ?Subroutine0

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine0:
        CFI Block cfiBlock1 Using cfiCommon0
        CFI NoFunction
        CFI CFA_SP SP+-5
        CFI DPL0 Frame(CFA_SP, 4)
        CFI DPH0 Frame(CFA_SP, 5)
        POP     DPH
        CFI CFA_SP SP+-4
        CFI DPH0 SameValue
        POP     DPL
        CFI CFA_SP SP+-3
        CFI DPL0 SameValue
        LJMP    ?BRET
        CFI EndBlock cfiBlock1
//  133 
//  134 
//  135 /*********************************************************************
//  136  * @fn      CommonApp_MessageMSGCB
//  137  *
//  138  * @brief   Data message processor callback.  This function processes
//  139  *          any incoming data - probably from other devices.  So, based
//  140  *          on cluster ID, perform the intended action.
//  141  *
//  142  * @param   none
//  143  *
//  144  * @return  none
//  145  */
//  146 

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  147 void CommonApp_MessageMSGCB( afIncomingMSGPacket_t *pkt )
CommonApp_MessageMSGCB:
        CFI Block cfiBlock2 Using cfiCommon0
        CFI Function CommonApp_MessageMSGCB
        CODE
//  148 {
        FUNCALL CommonApp_MessageMSGCB, RS485_GetDevDataSend
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
        CFI DPL0 Frame(CFA_SP, 4)
        CFI CFA_SP SP+-4
        PUSH    DPH
        CFI DPH0 Frame(CFA_SP, 5)
        CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
//  149   switch ( pkt->clusterId )
        MOV     DPL,R2
        MOV     DPH,R3
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,#0x1
        JNZ     ??CommonApp_MessageMSGCB_0
        INC     DPTR
        MOVX    A,@DPTR
??CommonApp_MessageMSGCB_0:
        JNZ     ??CommonApp_MessageMSGCB_1
//  150   {
//  151     case COMMONAPP_CLUSTERID:
//  152 #ifndef RS485_DEV
//  153       CommonApp_GetDevDataSend(pkt->cmd.Data, pkt->cmd.DataLength);
//  154 #else
//  155       RS485_GetDevDataSend(pkt->cmd.Data, pkt->cmd.DataLength);
        ; Setup parameters for call to function RS485_GetDevDataSend
        MOV     A,R2
        ADD     A,#0x20
        MOV     DPL,A
        MOV     A,R3
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R4,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R5,A
        MOV     A,R2
        ADD     A,#0x22
        MOV     DPL,A
        MOV     A,R3
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        LCALL   ??RS485_GetDevDataSend?relay
//  156 #endif
//  157       break; 
//  158   }
//  159 }
??CommonApp_MessageMSGCB_1:
        SJMP    ?Subroutine0
        CFI EndBlock cfiBlock2
//  160 
//  161 
//  162 /*********************************************************************
//  163  * @fn      CommonApp_ProcessZDOStates
//  164  *
//  165  * @brief   Process when network change
//  166  *
//  167  * @param   network status
//  168  *
//  169  * @return  none
//  170  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  171 void CommonApp_ProcessZDOStates(devStates_t status)
CommonApp_ProcessZDOStates:
        CFI Block cfiBlock3 Using cfiCommon0
        CFI Function CommonApp_ProcessZDOStates
        CODE
//  172 {
        ; Saved register size: 0
        ; Auto size: 0
//  173 #ifndef  RS485_DEV
//  174   if(status == DEV_ZB_COORD || status == DEV_ROUTER)
//  175   {
//  176 	nwkAddr = NLME_GetShortAddr();
//  177 	incode_2_to_16(SHORT_ADDR_G, (uint8 *)&nwkAddr, 2);
//  178 	memcpy(macAddr, NLME_GetExtAddr(), sizeof(ZLongAddr_t));
//  179     incode_2_to_16(EXT_ADDR_G, macAddr, 8);
//  180 
//  181 #ifdef ZDO_COORDINATOR
//  182 	UC_t mFrame;
//  183 
//  184 	memcpy(mFrame.head, FR_HEAD_UC, 3);
//  185 	mFrame.type = FR_DEV_COORD;
//  186 	memcpy(mFrame.ed_type, FR_APP_DEV, 2);
//  187 	memcpy(mFrame.short_addr, SHORT_ADDR_G, 4);
//  188 	memcpy(mFrame.ext_addr, EXT_ADDR_G, 16);
//  189 	incode_2_to_16(mFrame.panid, (uint8 *)&_NIB.nwkPanId, 2);
//  190 	uint16 channel = _NIB.nwkLogicalChannel;
//  191 	incode_2_to_16(mFrame.channel, (uint8 *)&channel, 2);
//  192     mFrame.data = NULL;
//  193 	mFrame.data_len = 0;
//  194 	memcpy(mFrame.tail, f_tail, 4);
//  195 
//  196 	if(!SSAFrame_Package(HEAD_UC, &mFrame, &fBuf, &fLen))
//  197 	{
//  198 	  CommonApp_GetDevDataSend(fBuf, fLen);
//  199 	}
//  200 #else
//  201 	UO_t mFrame;
//  202 	
//  203 	memcpy(mFrame.head, FR_HEAD_UO, 3);
//  204 	mFrame.type = FR_DEV_ROUTER;
//  205 	memcpy(mFrame.ed_type, FR_APP_DEV, 2);
//  206 	memcpy(mFrame.short_addr, SHORT_ADDR_G, 4);
//  207 	memcpy(mFrame.ext_addr, EXT_ADDR_G, 16);
//  208 	mFrame.data = NULL;
//  209 	mFrame.data_len = 0;
//  210 	memcpy(mFrame.tail, f_tail, 4);
//  211 
//  212 	if(!SSAFrame_Package(HEAD_UO, &mFrame, &fBuf, &fLen))
//  213 	{
//  214 		CommonApp_GetDevDataSend(fBuf, fLen);
//  215 		CommonApp_SendTheMessage(COORDINATOR_ADDR, fBuf, fLen);
//  216 	}
//  217 
//  218 	ConnectorApp_HeartBeatEvent();
//  219 #endif
//  220   }
//  221   
//  222 #else
//  223 
//  224 #endif
//  225 }
        LJMP    ?BRET
        CFI EndBlock cfiBlock3
//  226 
//  227 
//  228 #ifndef HAL_KEY_LONG_SHORT_DISTINGUISH

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  229 void CommonApp_HandleCombineKeys(uint16 keys, uint8 keyCounts)
CommonApp_HandleCombineKeys:
        CFI Block cfiBlock4 Using cfiCommon0
        CFI Function CommonApp_HandleCombineKeys
        CODE
//  230 {
        FUNCALL CommonApp_HandleCombineKeys, HalLedBlink
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_HandleCombineKeys, zgWriteStartupOptions
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_HandleCombineKeys, ZDOInitDevice
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_HandleCombineKeys, CommonApp_PermitJoiningRequest
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_HandleCombineKeys, CommonApp_PermitJoiningRequest
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV     A,R1
        MOV     R6,A
//  231   if(
//  232 #ifdef KEY_PUSH_PORT_1_BUTTON
//  233     keys & HAL_KEY_PORT_1_SWITCH_3
//  234 #else
//  235 	keys & HAL_KEY_SW_6
//  236 #endif
//  237   )
        MOV     A,R2
        ANL     A,#0x20
        JZ      ??CommonApp_HandleCombineKeys_0
//  238   {
//  239 	switch( keyCounts)
        MOV     A,R6
        JZ      ??CommonApp_HandleCombineKeys_1
        ADD     A,#-0x3
        JZ      ??CommonApp_HandleCombineKeys_2
        SJMP    ??CommonApp_HandleCombineKeys_0
//  240 	{	
//  241 	case 0: //Long click listen
//  242 	//Reset factory mode
//  243 #if defined(HOLD_INIT_AUTHENTICATION)
//  244 		HalLedBlink ( HAL_LED_4, 0, 50, 100 );
??CommonApp_HandleCombineKeys_1:
        ; Setup parameters for call to function HalLedBlink
        MOV     R4,#0x64
        MOV     R5,#0x0
        MOV     R3,#0x32
        MOV     R2,#0x0
        MOV     R1,#0x8
        LCALL   ??HalLedBlink?relay
//  245 #if !defined(ZDO_COORDINATOR)
//  246 		if(devState != DEV_HOLD)
//  247 		{
//  248     		devStates_t tStates;
//  249   			if (ZSUCCESS == osal_nv_item_init( 
//  250   				ZCD_NV_NWK_HOLD_STARTUP, sizeof(tStates),  &tStates))
//  251   			{
//  252   				tStates = DEV_HOLD;
//  253     			osal_nv_write(
//  254 					ZCD_NV_NWK_HOLD_STARTUP, 0, sizeof(tStates),  &tStates);
//  255   			}
//  256 		}
//  257 #else
//  258   		devState = DEV_INIT;
        MOV     DPTR,#devState
        MOV     A,#0x1
        MOVX    @DPTR,A
//  259 #endif
//  260 
//  261 		zgWriteStartupOptions(ZG_STARTUP_SET, ZCD_STARTOPT_DEFAULT_NETWORK_STATE);
        ; Setup parameters for call to function zgWriteStartupOptions
        MOV     R2,#0x2
        MOV     R1,#-0x1
        LCALL   ??zgWriteStartupOptions?relay
//  262 		WatchDogEnable( WDTIMX );
        MOV     0xc9,#-0x58
        MOV     0xc9,#0x58
//  263 #endif
//  264 		break;
        SJMP    ??CommonApp_HandleCombineKeys_0
//  265 
//  266 	case 3:
//  267 		//permit\forbid add znet
//  268 		if(devState == DEV_HOLD)
??CommonApp_HandleCombineKeys_2:
        MOV     DPTR,#devState
        MOVX    A,@DPTR
        JNZ     ??CommonApp_HandleCombineKeys_3
//  269 		{
//  270 			ZDOInitDevice( 0 );
        ; Setup parameters for call to function ZDOInitDevice
        MOV     R2,#0x0
        MOV     R3,#0x0
        LCALL   ??ZDOInitDevice?relay
        SJMP    ??CommonApp_HandleCombineKeys_0
//  271 		}
//  272 		else
//  273 		{
//  274 			if(isPermitJoining)
??CommonApp_HandleCombineKeys_3:
        MOV     DPTR,#isPermitJoining
        MOVX    A,@DPTR
        JZ      ??CommonApp_HandleCombineKeys_4
//  275 			{
//  276 				CommonApp_PermitJoiningRequest(PERMIT_JOIN_FORBID);
        ; Setup parameters for call to function CommonApp_PermitJoiningRequest
        MOV     R1,#0x0
        SJMP    ??CommonApp_HandleCombineKeys_5
//  277 			}
//  278 			else
//  279 			{
//  280 				CommonApp_PermitJoiningRequest(PERMIT_JOIN_TIMEOUT);
??CommonApp_HandleCombineKeys_4:
        ; Setup parameters for call to function CommonApp_PermitJoiningRequest
        MOV     R1,#0x1e
??CommonApp_HandleCombineKeys_5:
        LCALL   ??CommonApp_PermitJoiningRequest?relay
        CFI EndBlock cfiBlock4
//  281 			}
//  282 		}
//  283 		break;
//  284 
//  285 	default: break;
//  286 	}
//  287   }
//  288 }
??CommonApp_HandleCombineKeys_0:
        REQUIRE ?Subroutine1
        REQUIRE WDCTL
        ; // Fall through to label ?Subroutine1

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine1:
        CFI Block cfiBlock5 Using cfiCommon0
        CFI NoFunction
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 9)
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        MOV     R7,#0x1
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock5
//  289 #else
//  290 void CommonApp_HandleCombineKeys(uint16 keys, uint8 keyCounts)
//  291 {
//  292   uint8 *keysID = get_keys_id();
//  293   uint8 *keysPush = get_keys_push();
//  294 
//  295   if (keysPush[0] == HAL_KEY_LONG_PUSH)
//  296   {
//  297   	if(osal_memcmp(keysID, "a", keyCounts) && keyCounts == 1)
//  298     {
//  299 		//permit\forbid add znet
//  300 		if(devState == DEV_HOLD)
//  301 		{
//  302 			ZDOInitDevice( 0 );
//  303 		}
//  304 		else
//  305 		{
//  306 			if(isPermitJoining)
//  307 			{
//  308 				CommonApp_PermitJoiningRequest(PERMIT_JOIN_FORBID);
//  309 			}
//  310 			else
//  311 			{
//  312 				CommonApp_PermitJoiningRequest(PERMIT_JOIN_TIMEOUT);
//  313 			}
//  314 		}
//  315     }
//  316     else if(osal_memcmp(keysID, "aaa", keyCounts) && keyCounts == 3)
//  317     {
//  318 		//Reset factory mode
//  319 #if defined(HOLD_INIT_AUTHENTICATION)
//  320 		HalLedBlink ( HAL_LED_4, 0, 50, 100 );
//  321 #if !defined(ZDO_COORDINATOR)
//  322 		if(devState != DEV_HOLD)
//  323 		{
//  324     		devStates_t tStates;
//  325   			if (ZSUCCESS == osal_nv_item_init( 
//  326   				ZCD_NV_NWK_HOLD_STARTUP, sizeof(tStates),  &tStates))
//  327   			{
//  328   				tStates = DEV_HOLD;
//  329     			osal_nv_write(
//  330 					ZCD_NV_NWK_HOLD_STARTUP, 0, sizeof(tStates),  &tStates);
//  331   			}
//  332 		}
//  333 #else
//  334   		devState = DEV_INIT;
//  335 #endif
//  336 
//  337 		zgWriteStartupOptions(ZG_STARTUP_SET, ZCD_STARTOPT_DEFAULT_NETWORK_STATE);
//  338 		WatchDogEnable( WDTIMX );
//  339 #endif
//  340     }
//  341   }
//  342 }
//  343 #endif
//  344 
//  345 #ifndef ZDO_COORDINATOR
//  346 void ConnectorApp_HeartBeatEvent(void)
//  347 {
//  348 	CommonApp_HeartBeatCB(NULL, NULL, NULL);
//  349 	
//  350 	set_user_event(CommonApp_TaskID, HEARTBERAT_EVT, CommonApp_HeartBeatCB, 
//  351   		HEARTBEAT_TIMEOUT, TIMER_LOOP_EXECUTION|TIMER_EVENT_RESIDENTS, NULL);
//  352 }
//  353 #endif
//  354 
//  355 

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  356 void ConnectorApp_TxHandler(uint8 txBuf[], uint8 txLen)
ConnectorApp_TxHandler:
        CFI Block cfiBlock6 Using cfiCommon0
        CFI Function ConnectorApp_TxHandler
        CODE
//  357 {
        FUNCALL ConnectorApp_TxHandler, CommonApp_RS485SendMessage
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
//  358 #ifndef  RS485_DEV
//  359   
//  360 	uint16 Send_shortAddr = 0;
//  361 
//  362 	if(txLen>=16 && !memcmp(txBuf, FR_HEAD_DE, 2)
//  363 		&& !memcmp(txBuf+2, FR_CMD_JOIN_CTRL, 4)
//  364 		&& !memcmp(txBuf+txLen-4, f_tail, 4))
//  365 	{
//  366 		if(!memcmp(txBuf+6, SHORT_ADDR_G, 4))
//  367 		{
//  368 			uint8 cmdData, ret;
//  369 			uint8 retData[2] = {0};
//  370 		
//  371 			cmdData = atox(txBuf+10, 2);
//  372 
//  373 			if(!cmdData)
//  374 				ret = !CommonApp_PermitJoiningRequest(PERMIT_JOIN_FORBID);
//  375 			else if(cmdData == 1)
//  376 				ret = !CommonApp_PermitJoiningRequest(PERMIT_JOIN_TIMEOUT);
//  377 
//  378 			incode_2_to_16(retData, &ret, 1);
//  379 			PermitJoin_Refresh(retData, 2);
//  380 		}
//  381 		else
//  382 		{
//  383 			incode_16_to_2(&Send_shortAddr, txBuf+6, 4);
//  384 			CommonApp_SendTheMessage(Send_shortAddr, txBuf, txLen);
//  385 		}
//  386 		
//  387 	}
//  388 	else if(txLen>=14 && !memcmp(txBuf, FR_HEAD_DE, 2)
//  389 		&& !memcmp(txBuf+2, FR_CMD_BROCAST_REFRESH, 4)
//  390 		&& !memcmp(txBuf+txLen-4, f_tail, 4))
//  391 	{
//  392 		incode_16_to_2(&Send_shortAddr, txBuf+6, 4);
//  393 		if(Send_shortAddr == COORDINATOR_ADDR)
//  394 		{
//  395 			CommonApp_ProcessZDOStates(DEV_ZB_COORD);
//  396 		}
//  397 		else
//  398 		{
//  399 			CommonApp_SendTheMessage(BROADCAST_ADDR, txBuf, txLen);
//  400 		}
//  401 	}
//  402 	else if(txLen>=14 && !memcmp(txBuf, FR_HEAD_DE, 2)
//  403 		&& (!memcmp(txBuf+2, FR_CMD_SINGLE_EXCUTE, 4)
//  404 		|| !memcmp(txBuf+2, FR_CMD_PEROID_EXCUTE, 4)
//  405 		|| !memcmp(txBuf+2, FR_CMD_PEROID_STOP, 4))
//  406 		&& !memcmp(txBuf+txLen-4, f_tail, 4))
//  407 	{
//  408 		incode_16_to_2(&Send_shortAddr, txBuf+6, 4);
//  409 		CommonApp_SendTheMessage(Send_shortAddr, txBuf, txLen);
//  410 	}
//  411 	else if(txLen>=14 && !memcmp(txBuf, FR_HEAD_DE, 2)
//  412 		&& !memcmp(txBuf+2, FR_CMD_SINGLE_REFRESH, 4)
//  413 		&& !memcmp(txBuf+txLen-4, f_tail, 4))
//  414 	{
//  415 		incode_16_to_2(&Send_shortAddr, txBuf+6, 4);
//  416 		if(Send_shortAddr == COORDINATOR_ADDR) //coord self
//  417 		{
//  418 			CommonApp_ProcessZDOStates(DEV_ZB_COORD);
//  419 		}
//  420 		else
//  421 		{
//  422 			CommonApp_SendTheMessage(Send_shortAddr, txBuf, txLen);
//  423 		}
//  424 	}
//  425 #else
//  426       CommonApp_RS485SendMessage(txBuf, txLen);
        ; Setup parameters for call to function CommonApp_RS485SendMessage
        LCALL   ??CommonApp_RS485SendMessage?relay
//  427 #endif
//  428 }
        SJMP    ?Subroutine1
        CFI EndBlock cfiBlock6
//  429 
//  430 
//  431 /*********************************************************************
//  432  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  433 void CommonApp_RS485SendMessage(uint8 *data, uint8 length)
CommonApp_RS485SendMessage:
        CFI Block cfiBlock7 Using cfiCommon0
        CFI Function CommonApp_RS485SendMessage
        CODE
//  434 {
        FUNCALL CommonApp_RS485SendMessage, CommonApp_SendTheMessage
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_RS485SendMessage, get_NodeList
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_RS485SendMessage, CommonApp_SendTheMessage
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xc
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 0
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
        MOV     ?V0 + 0,R1
//  435    uint16 dest_addr;
//  436    uint8 dev_addr=data[0];
//  437     if(data[0]==0xFA)
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,#-0x6
        XRL     A,R1
        JNZ     ??CommonApp_RS485SendMessage_0
//  438   {
//  439     CommonApp_SendTheMessage(BROADCAST_ADDR, data,length);
        ; Setup parameters for call to function CommonApp_SendTheMessage
        MOV     R1,?V0 + 0
        MOV     A,R6
        MOV     R4,A
        MOV     A,R7
        MOV     R5,A
        MOV     R2,#-0x1
        MOV     R3,#-0x1
        SJMP    ??CommonApp_RS485SendMessage_1
//  440   }
//  441   else
//  442   {
//  443     //get the short_addr
//  444    dest_addr=get_NodeList(dev_addr);
??CommonApp_RS485SendMessage_0:
        ; Setup parameters for call to function get_NodeList
        LCALL   ??get_NodeList?relay
//  445    if(dest_addr)
        MOV     A,R2
        ORL     A,R3
        JZ      ??CommonApp_RS485SendMessage_2
//  446    CommonApp_SendTheMessage(dest_addr, data,length);
        ; Setup parameters for call to function CommonApp_SendTheMessage
        MOV     R1,?V0 + 0
        MOV     A,R6
        MOV     R4,A
        MOV     A,R7
        MOV     R5,A
??CommonApp_RS485SendMessage_1:
        LCALL   ??CommonApp_SendTheMessage?relay
//  447   }
//  448    //CommonApp_SendTheMessage(BROADCAST_ADDR, data,length);
//  449 }
??CommonApp_RS485SendMessage_2:
        MOV     R7,#0x4
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock7

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??CommonApp_InitConfirm?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    CommonApp_InitConfirm

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??CommonApp_MessageMSGCB?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    CommonApp_MessageMSGCB

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??CommonApp_ProcessZDOStates?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    CommonApp_ProcessZDOStates

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??CommonApp_HandleCombineKeys?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    CommonApp_HandleCombineKeys

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ConnectorApp_TxHandler?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    ConnectorApp_TxHandler

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??CommonApp_RS485SendMessage?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    CommonApp_RS485SendMessage

        END
// 
// 244 bytes in segment BANKED_CODE
//  36 bytes in segment BANK_RELAYS
//   1 byte  in segment SFR_AN
//   1 byte  in segment XDATA_Z
// 
// 280 bytes of CODE  memory
//   0 bytes of DATA  memory (+ 1 byte shared)
//   1 byte  of XDATA memory
//
//Errors: none
//Warnings: 2
