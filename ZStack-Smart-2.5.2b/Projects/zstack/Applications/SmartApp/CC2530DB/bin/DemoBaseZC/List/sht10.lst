###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.1.10194/W32 for 8051         23/Nov/2016  19:49:01 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\Source\Manage\sht10.c       #
#    Command line       =  -f E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zst #
#                          ack\Applications\SmartApp\CC2530DB\Devices\..\..\. #
#                          .\..\Tools\CC2530DB\f8wCoord.cfg (-DCPU32MHZ       #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRU #
#                          E -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8       #
#                          -DMAC_CFG_RX_MAX=5 -DZDO_COORDINATOR -DRTR_NWK     #
#                          -DSSA_CONNECTOR) -f E:\work\zigbee\ZStack-Smart-2. #
#                          5.2b\Projects\zstack\Applications\SmartApp\CC2530D #
#                          B\Devices\..\..\..\..\Tools\CC2530DB\f8wConfig.cfg #
#                           (-DZIGBEEPRO -DSECURE=1 -DZG_SECURE_DYNAMIC=1     #
#                          -DREFLECTOR -DDEFAULT_CHANLIST=0x00000800          #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=600         #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)   #
#                          -DREJOIN_POLL_RATE=440 E:\work\zigbee\ZStack-Smart #
#                          -2.5.2b\Projects\zstack\Applications\SmartApp\Sour #
#                          ce\Manage\sht10.c -D SECURE=1 -D ZTOOL_P1 -D       #
#                          DEVICE_TYPE_ID=0xFE -D SIGNAL_AMPLIFIER_SETTING    #
#                          -D xPOWER_AMPLIFIER_POSITION_1 -D xNWK_AUTO_POLL   #
#                          -D xHAL_UART_DMA=2 -D xHAL_UART_DMA_ALT1 -D        #
#                          xJIAJU_BUILDIN -D MT_TASK -D MT_SYS_FUNC -D        #
#                          MT_ZDO_FUNC -D NV_INIT -D NV_RESTORE -lC           #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\bin\DemoBaseZC\Lis #
#                          t\ -lA E:\work\zigbee\ZStack-Smart-2.5.2b\Projects #
#                          \zstack\Applications\SmartApp\CC2530DB\bin\DemoBas #
#                          eZC\List\ --diag_suppress Pe001,Pa010 -o           #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\bin\DemoBaseZC\Obj #
#                          \ -e --debug --core=plain --dptr=16,1              #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zst #
#                          ack\Applications\SmartApp\CC2530DB\Devices\ -I     #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\Sour #
#                          ce\Common\ -I E:\work\zigbee\ZStack-Smart-2.5.2b\P #
#                          rojects\zstack\Applications\SmartApp\CC2530DB\Devi #
#                          ces\..\..\Source\Connector\ -I                     #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\Sour #
#                          ce\\EndNode\ -I E:\work\zigbee\ZStack-Smart-2.5.2b #
#                          \Projects\zstack\Applications\SmartApp\CC2530DB\De #
#                          vices\..\..\Source\Board\ -I                       #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\Sour #
#                          ce\Manage\ -I E:\work\zigbee\ZStack-Smart-2.5.2b\P #
#                          rojects\zstack\Applications\SmartApp\CC2530DB\Devi #
#                          ces\..\..\Source\Manage\Callbacks\ -I              #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\Sour #
#                          ce\Manage\debug\ -I E:\work\zigbee\ZStack-Smart-2. #
#                          5.2b\Projects\zstack\Applications\SmartApp\CC2530D #
#                          B\Devices\..\..\Source\Manage\HeartBeat\ -I        #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\Sour #
#                          ce\Manage\incode\ -I E:\work\zigbee\ZStack-Smart-2 #
#                          .5.2b\Projects\zstack\Applications\SmartApp\CC2530 #
#                          DB\Devices\..\..\..\..\ZMain\TI2530DB\ -I          #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\..\. #
#                          .\..\..\Components\hal\include\ -I                 #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\..\. #
#                          .\..\..\Components\hal\target\CC2530EB\ -I         #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\..\. #
#                          .\..\..\Components\mac\include\ -I                 #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\..\. #
#                          .\..\..\Components\mac\high_level\ -I              #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\..\. #
#                          .\..\..\Components\mac\low_level\srf04\ -I         #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\..\. #
#                          .\..\..\Components\mac\low_level\srf04\single_chip #
#                          \ -I E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\z #
#                          stack\Applications\SmartApp\CC2530DB\Devices\..\.. #
#                          \..\..\..\..\Components\mt\ -I                     #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\..\. #
#                          .\..\..\Components\osal\include\ -I                #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\..\. #
#                          .\..\..\Components\services\saddr\ -I              #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\..\. #
#                          .\..\..\Components\services\sdata\ -I              #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\..\. #
#                          .\..\..\Components\stack\af\ -I                    #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\..\. #
#                          .\..\..\Components\stack\nwk\ -I                   #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\..\. #
#                          .\..\..\Components\stack\sapi\ -I                  #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\..\. #
#                          .\..\..\Components\stack\sec\ -I                   #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\..\. #
#                          .\..\..\Components\stack\sys\ -I                   #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\..\. #
#                          .\..\..\Components\stack\zdo\ -I                   #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\..\. #
#                          .\..\..\Components\zmac\ -I                        #
#                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\Devices\..\..\..\. #
#                          .\..\..\Components\zmac\f8w\ -Oh                   #
#                          --require_prototypes                               #
#    List file          =  E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\bin\DemoBaseZC\Lis #
#                          t\sht10.lst                                        #
#    Object file        =  E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack #
#                          \Applications\SmartApp\CC2530DB\bin\DemoBaseZC\Obj #
#                          \sht10.r51                                         #
#                                                                             #
#                                                                             #
###############################################################################

E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack\Applications\SmartApp\Source\Manage\sht10.c
      1          #include "sht10.h"

   \                                 In  segment SFR_AN, at 0x80
   \   union <unnamed> volatile __sfr _A_P0
   \                     _A_P0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf3
   \   unsigned char volatile __sfr P0SEL
   \                     P0SEL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfd
   \   unsigned char volatile __sfr P0DIR
   \                     P0DIR:
   \   000000                DS 1

   \                                 In  segment XDATA_Z, align 1, keep-with-next
      2          struct SHT11_DATA_STAUCT  SHT11;
   \                     SHT11:
   \   000000                DS 26
   \   00001A                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
      3          static unsigned char flag = 0;
   \                     flag:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
      4          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
      5          void SHT11_Delay(unsigned char us)
   \                     SHT11_Delay:
      6          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   \   000000   E9           MOV     A,R1
   \   000001   600C         JZ      ??SHT11_Delay_0
      7          	while(us--)
      8          	{
      9          		asm("NOP");
   \                     ??SHT11_Delay_1:
   \   000003   00           NOP
     10          		asm("NOP");
   \   000004   00           NOP
     11          		asm("NOP");
   \   000005   00           NOP
     12          		asm("NOP");
   \   000006   00           NOP
     13          		asm("NOP");
   \   000007   00           NOP
     14          		asm("NOP");
   \   000008   00           NOP
     15          		asm("NOP");
   \   000009   00           NOP
     16          		asm("NOP");
   \   00000A   00           NOP
     17          	}
   \   00000B   19           DEC     R1
   \   00000C   E9           MOV     A,R1
   \   00000D   70F4         JNZ     ??SHT11_Delay_1
     18          }
   \                     ??SHT11_Delay_0:
   \   00000F   02....       LJMP    ?BRET
     19          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     20          void SHT11_Delay_Ms(unsigned char ms)
   \                     SHT11_Delay_Ms:
     21          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
     22          	unsigned char i;
     23          	for(i=0;i<ms;i++)
   \   000006   600B         JZ      ??SHT11_Delay_Ms_0
   \   000008   FE           MOV     R6,A
     24          	{
     25          	SHT11_Delay(250);
   \                     ??SHT11_Delay_Ms_1:
   \   000009                ; Setup parameters for call to function SHT11_Delay
   \   000009   12....       LCALL   ?Subroutine3 & 0xFFFF
     26          	SHT11_Delay(250);
     27          	SHT11_Delay(250);
   \                     ??CrossCallReturnLabel_2:
   \   00000C                ; Setup parameters for call to function SHT11_Delay
   \   00000C   12....       LCALL   ?Subroutine3 & 0xFFFF
     28          	SHT11_Delay(250);
     29          	}
   \                     ??CrossCallReturnLabel_3:
   \   00000F   1E           DEC     R6
   \   000010   EE           MOV     A,R6
   \   000011   70F6         JNZ     ??SHT11_Delay_Ms_1
     30          }
   \                     ??SHT11_Delay_Ms_0:
   \   000013                REQUIRE ?Subroutine1
   \   000013                ; // Fall through to label ?Subroutine1

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   7F01         MOV     R7,#0x1
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   79FA         MOV     R1,#-0x6
   \   000002   12....       LCALL   ??SHT11_Delay?relay
   \   000005                ; Setup parameters for call to function SHT11_Delay
   \   000005                ; Setup parameters for call to function SHT11_Delay
   \   000005                ; Setup parameters for call to function SHT11_Delay
   \   000005   79FA         MOV     R1,#-0x6
   \   000007   12....       LCALL   ??SHT11_Delay?relay
   \   00000A   22           RET
     31          
     32          /********************
     33          *数据线依次输入1  0  表示启动
     34          时钟的时序为时钟线拉低再拉高
     35          *********************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     36          void SHT11_Start(void)
   \                     SHT11_Start:
     37          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
     38          	SHT11_DATA_OUT;//数据为输出模式
   \   000004   43FD40       ORL     0xfd,#0x40
     39          /*-------------------1--------------*/
     40          	SHT11_DATA  = 1;//数据为1
   \   000007   D286         SETB    0x80.6
     41          
     42          	SHT11_SCL_RESET;//scl=0
   \   000009   C287         CLR     0x80.7
     43          	SHT11_Delay(5);
   \   00000B                ; Setup parameters for call to function SHT11_Delay
   \   00000B   7905         MOV     R1,#0x5
   \   00000D   12....       LCALL   ??SHT11_Delay?relay
     44          	SHT11_SCL_SET;//scl =1
   \   000010   D287         SETB    0x80.7
     45          	
     46          	SHT11_Delay(1);
   \   000012                ; Setup parameters for call to function SHT11_Delay
   \   000012   7901         MOV     R1,#0x1
   \   000014   12....       LCALL   ??SHT11_Delay?relay
     47          /*-------------------0--------------*/
     48          	SHT11_DATA =0;//数据为0
   \   000017   C286         CLR     0x80.6
     49          	SHT11_SCL_RESET;//scl=0
   \   000019   C287         CLR     0x80.7
     50          	SHT11_Delay(5);
   \   00001B                ; Setup parameters for call to function SHT11_Delay
   \   00001B   7905         MOV     R1,#0x5
   \   00001D   12....       LCALL   ??SHT11_Delay?relay
     51          	SHT11_SCL_SET;//scl=1
   \   000020   D287         SETB    0x80.7
     52          
     53          	SHT11_DATA = 1;//SDA=1
   \   000022   D286         SETB    0x80.6
     54          	SHT11_SCL_RESET;//SCL=0
   \   000024   C287         CLR     0x80.7
     55          	
     56          }
   \   000026                REQUIRE ?Subroutine0
   \   000026                REQUIRE P0DIR
   \   000026                REQUIRE _A_P0
   \   000026                ; // Fall through to label ?Subroutine0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   D083         POP     DPH
   \   000002   D082         POP     DPL
   \   000004   02....       LJMP    ?BRET
     57          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     58          void SHT11_Reset(void)
   \                     SHT11_Reset:
     59          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
     60          	unsigned char i;
     61          	SHT11_DATA_OUT;//输出模式
   \   000004   43FD40       ORL     0xfd,#0x40
     62          	SHT11_DATA=1;
   \   000007   D286         SETB    0x80.6
     63          	asm("NOP");
   \   000009   00           NOP
     64          	SHT11_SCL_RESET;
   \   00000A   C287         CLR     0x80.7
     65          	asm("NOP");
   \   00000C   00           NOP
     66          	for(i=0;i<9;i++)
   \   00000D   7409         MOV     A,#0x9
     67          	{
     68          		SHT11_SCL_SET;
   \                     ??SHT11_Reset_0:
   \   00000F   D287         SETB    0x80.7
     69          		asm("NOP");
   \   000011   00           NOP
     70          		SHT11_SCL_RESET;
   \   000012   C287         CLR     0x80.7
     71          		asm("NOP");
   \   000014   00           NOP
     72          	}
   \   000015   14           DEC     A
   \   000016   70F7         JNZ     ??SHT11_Reset_0
     73          	SHT11_Start();//启动SHT11
   \   000018                ; Setup parameters for call to function SHT11_Start
   \   000018   12....       LCALL   ??SHT11_Start?relay
     74          	
     75          }
   \   00001B   80..         SJMP    ?Subroutine0
   \   00001D                REQUIRE P0DIR
   \   00001D                REQUIRE _A_P0
     76          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     77          unsigned char SHT11_Write_Byte(unsigned char byte)
   \                     SHT11_Write_Byte:
     78          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FF           MOV     R7,A
     79          		unsigned char i;
     80          		unsigned char status =1;//状态
     81          		SHT11_DATA_OUT;//数据输出模式
   \   000007   43FD40       ORL     0xfd,#0x40
     82          		for(i=0;i<8;i++)
   \   00000A   7E08         MOV     R6,#0x8
     83          		{
     84          		//一个字节由高位到低位写入SHT11
     85          		if((byte & 0x80)==0x80) 
   \                     ??SHT11_Write_Byte_0:
   \   00000C   EF           MOV     A,R7
   \   00000D   A2E7         MOV     C,0xE0 /* A   */.7
   \   00000F   5004         JNC     ??SHT11_Write_Byte_1
     86          			SHT11_DATA =1;
   \   000011   D286         SETB    0x80.6
   \   000013   8002         SJMP    ??SHT11_Write_Byte_2
     87          		else
     88          			SHT11_DATA =0;
   \                     ??SHT11_Write_Byte_1:
   \   000015   C286         CLR     0x80.6
     89          		//拉高时钟线,延时5US,脉冲写入
     90          		SHT11_SCL_SET;
   \                     ??SHT11_Write_Byte_2:
   \   000017   D287         SETB    0x80.7
     91          		SHT11_Delay(5);
   \   000019                ; Setup parameters for call to function SHT11_Delay
   \   000019   7905         MOV     R1,#0x5
   \   00001B   12....       LCALL   ??SHT11_Delay?relay
     92          		SHT11_SCL_RESET;
   \   00001E   C287         CLR     0x80.7
     93          		byte <<=1;
   \   000020   EF           MOV     A,R7
   \   000021   C3           CLR     C
   \   000022   33           RLC     A
   \   000023   FF           MOV     R7,A
     94          		}
   \   000024   1E           DEC     R6
   \   000025   EE           MOV     A,R6
   \   000026   70E4         JNZ     ??SHT11_Write_Byte_0
     95          		SHT11_DATA =1;//释放数据线
   \   000028   D286         SETB    0x80.6
     96          		SHT11_DATA_IN;//输入模式，未接收准备
   \   00002A   53FDBF       ANL     0xfd,#0xbf
     97          		SHT11_SCL_SET;//scl=1
   \   00002D   D287         SETB    0x80.7
     98          		status = SHT11_DATA;//接收应答
   \   00002F   E580         MOV     A,0x80
     99          		//默认状态
    100          		SHT11_SCL_RESET;//拉低
   \   000031   C287         CLR     0x80.7
    101          		if(status == 0)
   \   000033   A2E6         MOV     C,0xE0 /* A   */.6
   \   000035   4004         JC      ??SHT11_Write_Byte_3
    102          			{
    103          			return SUCCESS_1;
   \   000037   7901         MOV     R1,#0x1
   \   000039   8002         SJMP    ??SHT11_Write_Byte_4
    104          			}
    105          		else
    106          			{
    107          			return ERROR_1;
   \                     ??SHT11_Write_Byte_3:
   \   00003B   7902         MOV     R1,#0x2
    108          			}		
   \                     ??SHT11_Write_Byte_4:
   \   00003D   02....       LJMP    ?Subroutine1 & 0xFFFF
   \   000040                REQUIRE P0DIR
   \   000040                REQUIRE _A_P0
    109          }
    110          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    111          char SHT11_Read_Byte(unsigned char ack_status)
   \                     SHT11_Read_Byte:
    112          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 0,R1
    113          	unsigned char i;
    114          	unsigned char byte =0;
   \   000007   7E00         MOV     R6,#0x0
    115          	SHT11_DATA_IN;//输入模式
   \   000009   53FDBF       ANL     0xfd,#0xbf
    116          	for(i=0;i<8;i++)
   \   00000C   7F08         MOV     R7,#0x8
    117          	{
    118          	byte <<=1;//往高位移1位
   \                     ??SHT11_Read_Byte_0:
   \   00000E   EE           MOV     A,R6
   \   00000F   C3           CLR     C
   \   000010   33           RLC     A
   \   000011   FE           MOV     R6,A
    119          	SHT11_SCL_SET;//scl=1
   \   000012   D287         SETB    0x80.7
    120          	SHT11_Delay(5);
   \   000014                ; Setup parameters for call to function SHT11_Delay
   \   000014   7905         MOV     R1,#0x5
   \   000016   12....       LCALL   ??SHT11_Delay?relay
    121          
    122          	if(SHT11_DATA)
   \   000019   A286         MOV     C,0x80.6
   \   00001B   5005         JNC     ??SHT11_Read_Byte_1
    123          		{
    124          		byte |=0x01;
   \   00001D   D3           SETB    C
   \   00001E   EE           MOV     A,R6
   \   00001F   D2E0         SETB    0xE0 /* A   */.0
   \   000021   FE           MOV     R6,A
    125          		}
    126          	SHT11_SCL_RESET;//SCL=0
   \                     ??SHT11_Read_Byte_1:
   \   000022   C287         CLR     0x80.7
    127          	}
   \   000024   1F           DEC     R7
   \   000025   EF           MOV     A,R7
   \   000026   70E6         JNZ     ??SHT11_Read_Byte_0
    128          
    129          	SHT11_DATA_OUT;//输出模式
   \   000028   43FD40       ORL     0xfd,#0x40
    130          	SHT11_DATA = !ack_status;//是否要应答
   \   00002B   E5..         MOV     A,?V0 + 0
   \   00002D   7004         JNZ     ??SHT11_Read_Byte_2
   \   00002F   7401         MOV     A,#0x1
   \   000031   8001         SJMP    ??SHT11_Read_Byte_3
   \                     ??SHT11_Read_Byte_2:
   \   000033   E4           CLR     A
   \                     ??SHT11_Read_Byte_3:
   \   000034   C4           SWAP    A
   \   000035   33           RLC     A
   \   000036   33           RLC     A
   \   000037   54C0         ANL     A,#0xc0
   \   000039   F8           MOV     R0,A
   \   00003A   E580         MOV     A,0x80
   \   00003C   54BF         ANL     A,#0xbf
   \   00003E   48           ORL     A,R0
   \   00003F   F580         MOV     0x80,A
    131          	//拉高时钟等待应答
    132          	SHT11_SCL_SET;
   \   000041   D287         SETB    0x80.7
    133          	SHT11_Delay(5);
   \   000043                ; Setup parameters for call to function SHT11_Delay
   \   000043   7905         MOV     R1,#0x5
   \   000045   12....       LCALL   ??SHT11_Delay?relay
    134          	SHT11_SCL_RESET;
   \   000048   C287         CLR     0x80.7
    135          
    136          	SHT11_DATA =1;//释放数据线
   \   00004A   D286         SETB    0x80.6
    137          	return byte;
   \   00004C   EE           MOV     A,R6
   \   00004D   F9           MOV     R1,A
   \   00004E   02....       LJMP    ?Subroutine1 & 0xFFFF
   \   000051                REQUIRE P0DIR
   \   000051                REQUIRE _A_P0
    138          }
    139          
    140          /*MODE 选择采集湿度还是温度
    141          */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    142          unsigned char SHT11_Order(unsigned char mode)
   \                     SHT11_Order:
    143          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 1,R1
    144          	unsigned char status;//success or error
    145          	unsigned char i;
    146          	unsigned char count = 0;
   \   000007   75..00       MOV     ?V0 + 0,#0x0
    147          	if(mode == MODE_TEMP)
   \   00000A   E9           MOV     A,R1
   \   00000B   7004         JNZ     ??SHT11_Order_0
    148          		{
    149          		status = SHT11_Write_Byte(SHT11_TEMP);//监测温度
   \   00000D                ; Setup parameters for call to function SHT11_Write_Byte
   \   00000D   7903         MOV     R1,#0x3
   \   00000F   8008         SJMP    ??SHT11_Order_1
    150          		}
    151          	else if(mode == MODE_HUMI)
   \                     ??SHT11_Order_0:
   \   000011   7401         MOV     A,#0x1
   \   000013   65..         XRL     A,?V0 + 1
   \   000015   7007         JNZ     ??SHT11_Order_2
    152          		{
    153          		status = SHT11_Write_Byte(SHT11_HUMI);//监测湿度
   \   000017                ; Setup parameters for call to function SHT11_Write_Byte
   \   000017   7905         MOV     R1,#0x5
   \                     ??SHT11_Order_1:
   \   000019   12....       LCALL   ??SHT11_Write_Byte?relay
   \   00001C   E9           MOV     A,R1
   \   00001D   FE           MOV     R6,A
    154          		}
    155          	if(status == SUCCESS_1)
   \                     ??SHT11_Order_2:
   \   00001E   7401         MOV     A,#0x1
   \   000020   6E           XRL     A,R6
   \   000021   701A         JNZ     ??SHT11_Order_3
    156          		{
    157          		/*写入命令成功*/
    158          		while(SHT11_DATA)
   \                     ??SHT11_Order_4:
   \   000023   A286         MOV     C,0x80.6
   \   000025   5019         JNC     ??SHT11_Order_5
    159          			{
    160          			for(i=0;i<200;i++)
   \   000027   7FC8         MOV     R7,#-0x38
    161          				{
    162          				SHT11_Delay(250);
   \                     ??SHT11_Order_6:
   \   000029                ; Setup parameters for call to function SHT11_Delay
   \   000029   12....       LCALL   ?Subroutine3 & 0xFFFF
    163          				SHT11_Delay(250);
    164          				}//100ms
   \                     ??CrossCallReturnLabel_4:
   \   00002C   1F           DEC     R7
   \   00002D   EF           MOV     A,R7
   \   00002E   70F9         JNZ     ??SHT11_Order_6
    165          				count++;
   \   000030   05..         INC     ?V0 + 0
    166          			if(count >=20)	
   \   000032   E5..         MOV     A,?V0 + 0
   \   000034   C3           CLR     C
   \   000035   9414         SUBB    A,#0x14
   \   000037   40EA         JC      ??SHT11_Order_4
    167          				{
    168          				status = ERROR_1;
   \   000039   7E02         MOV     R6,#0x2
    169          				break;
   \   00003B   8003         SJMP    ??SHT11_Order_5
    170          				//超过2S未响应
    171          				}
    172          			}
    173          		}
    174          	else
    175          		{
    176          		SHT11_Reset();
   \                     ??SHT11_Order_3:
   \   00003D                ; Setup parameters for call to function SHT11_Reset
   \   00003D   12....       LCALL   ??SHT11_Reset?relay
    177          		}
    178          	return status;
   \                     ??SHT11_Order_5:
   \   000040   EE           MOV     A,R6
   \   000041   F9           MOV     R1,A
   \   000042   7F02         MOV     R7,#0x2
   \   000044   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   000047                REQUIRE _A_P0
    179          }
    180          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    181          void SHT11_Get_Data(void)
   \                     SHT11_Get_Data:
    182          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    183          	unsigned int value =0;
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   E4           CLR     A
   \   000011   F0           MOVX    @DPTR,A
   \   000012   A3           INC     DPTR
   \   000013   F0           MOVX    @DPTR,A
    184          	SHT11_Reset();//复位
   \   000014                ; Setup parameters for call to function SHT11_Reset
   \   000014   12....       LCALL   ??SHT11_Reset?relay
    185          	if(SHT11_Order(MODE_HUMI)==SUCCESS_1)
   \   000017                ; Setup parameters for call to function SHT11_Order
   \   000017   7901         MOV     R1,#0x1
   \   000019   12....       LCALL   ??SHT11_Order?relay
   \   00001C   E9           MOV     A,R1
   \   00001D   6401         XRL     A,#0x1
   \   00001F   7009         JNZ     ??CrossCallReturnLabel_0
    186          		{
    187          		SHT11_Delay(250);
   \   000021                ; Setup parameters for call to function SHT11_Delay
   \   000021   12....       LCALL   ?Subroutine5 & 0xFFFF
    188          		*((unsigned char *)&value+1) = SHT11_Read_Byte(ACK);//高8位
    189          		*((unsigned char *)&value) = SHT11_Read_Byte(ACK);//低8位
    190          		SHT11_Read_Byte(noACK);//校验和
    191          		}
   \                     ??CrossCallReturnLabel_7:
   \   000024   12....       LCALL   ?XSTACK_DISP0_8
   \   000027   12....       LCALL   ?Subroutine2 & 0xFFFF
    192          	SHT11.Humi = value;//记录湿度
   \                     ??CrossCallReturnLabel_0:
   \   00002A   12....       LCALL   ?Subroutine4 & 0xFFFF
   \                     ??CrossCallReturnLabel_5:
   \   00002D   12....       LCALL   ?UL_TO_FLT
   \   000030   90....       MOV     DPTR,#SHT11 + 8
   \   000033   78..         MOV     R0,#?V0 + 0
   \   000035   12....       LCALL   ?L_MOV_TO_X
    193          	value =0;
   \   000038   85..82       MOV     DPL,?XSP + 0
   \   00003B   85..83       MOV     DPH,?XSP + 1
   \   00003E   E4           CLR     A
   \   00003F   F0           MOVX    @DPTR,A
   \   000040   A3           INC     DPTR
   \   000041   F0           MOVX    @DPTR,A
    194          	
    195          	SHT11_Reset();
   \   000042                ; Setup parameters for call to function SHT11_Reset
   \   000042   12....       LCALL   ??SHT11_Reset?relay
    196          	SHT11_Delay_Ms(200);
   \   000045                ; Setup parameters for call to function SHT11_Delay_Ms
   \   000045   79C8         MOV     R1,#-0x38
   \   000047   12....       LCALL   ??SHT11_Delay_Ms?relay
    197          	if (SHT11_Order(MODE_TEMP)==SUCCESS_1)
   \   00004A                ; Setup parameters for call to function SHT11_Order
   \   00004A   7900         MOV     R1,#0x0
   \   00004C   12....       LCALL   ??SHT11_Order?relay
   \   00004F   E9           MOV     A,R1
   \   000050   6401         XRL     A,#0x1
   \   000052   7009         JNZ     ??CrossCallReturnLabel_1
    198          		{
    199          		SHT11_Delay(250);
   \   000054                ; Setup parameters for call to function SHT11_Delay
   \   000054   12....       LCALL   ?Subroutine5 & 0xFFFF
    200          		*((unsigned char *)&value+1) = SHT11_Read_Byte(ACK);//高8位
    201          		*((unsigned char *)&value) = SHT11_Read_Byte(ACK);//低8位
    202          		SHT11_Read_Byte(noACK);//校验和
    203          		}
   \                     ??CrossCallReturnLabel_8:
   \   000057   12....       LCALL   ?XSTACK_DISP0_8
   \   00005A   12....       LCALL   ?Subroutine2 & 0xFFFF
    204          	SHT11.Temp = value;
   \                     ??CrossCallReturnLabel_1:
   \   00005D   12....       LCALL   ?Subroutine4 & 0xFFFF
   \                     ??CrossCallReturnLabel_6:
   \   000060   12....       LCALL   ?UL_TO_FLT
   \   000063   90....       MOV     DPTR,#SHT11 + 4
   \   000066   78..         MOV     R0,#?V0 + 0
   \   000068   12....       LCALL   ?L_MOV_TO_X
    205          }
   \   00006B   7402         MOV     A,#0x2
   \   00006D   12....       LCALL   ?DEALLOC_XSTACK8
   \   000070   7F04         MOV     R7,#0x4
   \   000072   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   79FA         MOV     R1,#-0x6
   \   000002   12....       LCALL   ??SHT11_Delay?relay
   \   000005                ; Setup parameters for call to function SHT11_Read_Byte
   \   000005                ; Setup parameters for call to function SHT11_Read_Byte
   \   000005   7901         MOV     R1,#0x1
   \   000007   12....       LCALL   ??SHT11_Read_Byte?relay
   \   00000A   7401         MOV     A,#0x1
   \   00000C   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   85..82       MOV     DPL,?XSP + 0
   \   000003   85..83       MOV     DPH,?XSP + 1
   \   000006   E0           MOVX    A,@DPTR
   \   000007   F5..         MOV     ?V0 + 0,A
   \   000009   A3           INC     DPTR
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   F5..         MOV     ?V0 + 1,A
   \   00000D   E4           CLR     A
   \   00000E   F5..         MOV     ?V0 + 2,A
   \   000010   F5..         MOV     ?V0 + 3,A
   \   000012   78..         MOV     R0,#?V0 + 0
   \   000014   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   E9           MOV     A,R1
   \   000001   F0           MOVX    @DPTR,A
   \   000002                ; Setup parameters for call to function SHT11_Read_Byte
   \   000002                ; Setup parameters for call to function SHT11_Read_Byte
   \   000002   7901         MOV     R1,#0x1
   \   000004   12....       LCALL   ??SHT11_Read_Byte?relay
   \   000007   E9           MOV     A,R1
   \   000008   85..82       MOV     DPL,?XSP + 0
   \   00000B   85..83       MOV     DPH,?XSP + 1
   \   00000E   F0           MOVX    @DPTR,A
   \   00000F                ; Setup parameters for call to function SHT11_Read_Byte
   \   00000F                ; Setup parameters for call to function SHT11_Read_Byte
   \   00000F   7900         MOV     R1,#0x0
   \   000011   12....       LCALL   ??SHT11_Read_Byte?relay
   \   000014   22           RET
    206          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    207          void SHT11_Real_Data(void)
   \                     SHT11_Real_Data:
    208          {
   \   000000   74E8         MOV     A,#-0x18
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 24
   \   000005                ; Auto size: 0
    209          	SHT11_Get_Data();//获取到温度和湿度数据
   \   000005                ; Setup parameters for call to function SHT11_Get_Data
   \   000005   12....       LCALL   ??SHT11_Get_Data?relay
    210          	const float C1 = -2.0468;//
    211          	const float C2 = +0.0367;
    212          	const float C3 = -0.0000015955;
    213          	const float T1 = +0.01;
    214          	const float T2 = +0.00008;
    215          
    216          	float rh = SHT11.Humi;//12位湿度
   \   000008   90....       MOV     DPTR,#SHT11 + 8
   \   00000B   78..         MOV     R0,#?V0 + 4
   \   00000D   12....       LCALL   ?L_MOV_X
    217          	float t = SHT11.Temp;//14为温度
    218          	float rh_lin;//温度极限值
    219          	float rh_true;//真实值
    220          	float t_C;
    221          
    222          	//t_C = t*0.01-40.1;//供电电压5V
    223                  t_C = t*0.01-39.6;//供电电压3.3V
   \   000010   90....       MOV     DPTR,#SHT11 + 4
   \   000013   78..         MOV     R0,#?V0 + 8
   \   000015   12....       LCALL   ?L_MOV_X
   \   000018   90....       MOV     DPTR,#__Constant_3c23d70a
   \   00001B   78..         MOV     R0,#?V0 + 0
   \   00001D   12....       LCALL   ?L_MOV_X
   \   000020   78..         MOV     R0,#?V0 + 8
   \   000022   79..         MOV     R1,#?V0 + 0
   \   000024   12....       LCALL   ?FLT_MUL
   \   000027   90....       MOV     DPTR,#__Constant_c21e6666
   \   00002A   78..         MOV     R0,#?V0 + 0
   \   00002C   12....       LCALL   ?L_MOV_X
   \   00002F   78..         MOV     R0,#?V0 + 8
   \   000031   79..         MOV     R1,#?V0 + 0
   \   000033   12....       LCALL   ?FLT_ADD
    224                  if(t_C<15)
   \   000036   90....       MOV     DPTR,#__Constant_41700000
   \   000039   78..         MOV     R0,#?V0 + 0
   \   00003B   12....       LCALL   ?L_MOV_X
   \   00003E   78..         MOV     R0,#?V0 + 8
   \   000040   79..         MOV     R1,#?V0 + 0
   \   000042   12....       LCALL   ?FLT_LT
   \   000045   5008         JNC     ??SHT11_Real_Data_0
    225                    t_C=0;
   \   000047   90....       MOV     DPTR,#__Constant_0
   \   00004A   78..         MOV     R0,#?V0 + 8
   \   00004C   12....       LCALL   ?L_MOV_X
    226                  else
    227                    t_C=t_C;
    228          	rh_lin = C3*rh*rh+C2*rh+C1;//相对湿度补偿
    229          	rh_true=(t_C-25)*(T1+T2*rh)+rh_lin;//相对湿度补偿
   \                     ??SHT11_Real_Data_0:
   \   00004F   85....       MOV     ?V0 + 0,?V0 + 8
   \   000052   85....       MOV     ?V0 + 1,?V0 + 9
   \   000055   85....       MOV     ?V0 + 2,?V0 + 10
   \   000058   85....       MOV     ?V0 + 3,?V0 + 11
   \   00005B   90....       MOV     DPTR,#__Constant_c1c80000
   \   00005E   78..         MOV     R0,#?V0 + 12
   \   000060   12....       LCALL   ?L_MOV_X
   \   000063   78..         MOV     R0,#?V0 + 0
   \   000065   79..         MOV     R1,#?V0 + 12
   \   000067   12....       LCALL   ?FLT_ADD
   \   00006A   C0..         PUSH    ?V0 + 0
   \   00006C   C0..         PUSH    ?V0 + 1
   \   00006E   C0..         PUSH    ?V0 + 2
   \   000070   C0..         PUSH    ?V0 + 3
   \   000072   85....       MOV     ?V0 + 0,?V0 + 4
   \   000075   85....       MOV     ?V0 + 1,?V0 + 5
   \   000078   85....       MOV     ?V0 + 2,?V0 + 6
   \   00007B   85....       MOV     ?V0 + 3,?V0 + 7
   \   00007E   90....       MOV     DPTR,#__Constant_38a7c5ac
   \   000081   78..         MOV     R0,#?V0 + 12
   \   000083   12....       LCALL   ?L_MOV_X
   \   000086   78..         MOV     R0,#?V0 + 0
   \   000088   79..         MOV     R1,#?V0 + 12
   \   00008A   12....       LCALL   ?FLT_MUL
   \   00008D   90....       MOV     DPTR,#__Constant_3c23d70a
   \   000090   78..         MOV     R0,#?V0 + 12
   \   000092   12....       LCALL   ?L_MOV_X
   \   000095   78..         MOV     R0,#?V0 + 0
   \   000097   79..         MOV     R1,#?V0 + 12
   \   000099   12....       LCALL   ?FLT_ADD
   \   00009C   D0..         POP     ?V0 + 15
   \   00009E   D0..         POP     ?V0 + 14
   \   0000A0   D0..         POP     ?V0 + 13
   \   0000A2   D0..         POP     ?V0 + 12
   \   0000A4   78..         MOV     R0,#?V0 + 12
   \   0000A6   79..         MOV     R1,#?V0 + 0
   \   0000A8   12....       LCALL   ?FLT_MUL
   \   0000AB   C0..         PUSH    ?V0 + 12
   \   0000AD   C0..         PUSH    ?V0 + 13
   \   0000AF   C0..         PUSH    ?V0 + 14
   \   0000B1   C0..         PUSH    ?V0 + 15
   \   0000B3   85....       MOV     ?V0 + 0,?V0 + 4
   \   0000B6   85....       MOV     ?V0 + 1,?V0 + 5
   \   0000B9   85....       MOV     ?V0 + 2,?V0 + 6
   \   0000BC   85....       MOV     ?V0 + 3,?V0 + 7
   \   0000BF   90....       MOV     DPTR,#__Constant_b5d624f6
   \   0000C2   78..         MOV     R0,#?V0 + 12
   \   0000C4   12....       LCALL   ?L_MOV_X
   \   0000C7   78..         MOV     R0,#?V0 + 0
   \   0000C9   79..         MOV     R1,#?V0 + 12
   \   0000CB   12....       LCALL   ?FLT_MUL
   \   0000CE   78..         MOV     R0,#?V0 + 0
   \   0000D0   79..         MOV     R1,#?V0 + 4
   \   0000D2   12....       LCALL   ?FLT_MUL
   \   0000D5   90....       MOV     DPTR,#__Constant_3d1652bd
   \   0000D8   78..         MOV     R0,#?V0 + 12
   \   0000DA   12....       LCALL   ?L_MOV_X
   \   0000DD   78..         MOV     R0,#?V0 + 4
   \   0000DF   79..         MOV     R1,#?V0 + 12
   \   0000E1   12....       LCALL   ?FLT_MUL
   \   0000E4   78..         MOV     R0,#?V0 + 0
   \   0000E6   79..         MOV     R1,#?V0 + 4
   \   0000E8   12....       LCALL   ?FLT_ADD
   \   0000EB   90....       MOV     DPTR,#__Constant_c002fec5
   \   0000EE   78..         MOV     R0,#?V0 + 4
   \   0000F0   12....       LCALL   ?L_MOV_X
   \   0000F3   78..         MOV     R0,#?V0 + 0
   \   0000F5   79..         MOV     R1,#?V0 + 4
   \   0000F7   12....       LCALL   ?FLT_ADD
   \   0000FA   D0..         POP     ?V0 + 7
   \   0000FC   D0..         POP     ?V0 + 6
   \   0000FE   D0..         POP     ?V0 + 5
   \   000100   D0..         POP     ?V0 + 4
   \   000102   78..         MOV     R0,#?V0 + 4
   \   000104   79..         MOV     R1,#?V0 + 0
   \   000106   12....       LCALL   ?FLT_ADD
    230          	if(rh_true>100)
   \   000109   90....       MOV     DPTR,#__Constant_42c80001
   \   00010C   78..         MOV     R0,#?V0 + 0
   \   00010E   12....       LCALL   ?L_MOV_X
   \   000111   78..         MOV     R0,#?V0 + 4
   \   000113   79..         MOV     R1,#?V0 + 0
   \   000115   12....       LCALL   ?FLT_GE
   \   000118   5005         JNC     ??SHT11_Real_Data_1
    231          		rh_true=100;
   \   00011A   90....       MOV     DPTR,#__Constant_42c80000
   \   00011D   8014         SJMP    ??SHT11_Real_Data_2
    232          	if(rh_true<0.1)
   \                     ??SHT11_Real_Data_1:
   \   00011F   90....       MOV     DPTR,#__Constant_3dcccccd
   \   000122   78..         MOV     R0,#?V0 + 0
   \   000124   12....       LCALL   ?L_MOV_X
   \   000127   78..         MOV     R0,#?V0 + 4
   \   000129   79..         MOV     R1,#?V0 + 0
   \   00012B   12....       LCALL   ?FLT_LT
   \   00012E   5008         JNC     ??SHT11_Real_Data_3
    233          		rh_true=0.1;
   \   000130   90....       MOV     DPTR,#__Constant_3dcccccd
   \                     ??SHT11_Real_Data_2:
   \   000133   78..         MOV     R0,#?V0 + 4
   \   000135   12....       LCALL   ?L_MOV_X
    234          	#ifndef SHT11_DATA_FLOAT
    235          	SHT11.Temp = (int)t_C;//返回温度
    236          	SHT11.Humi = (int)rh_true;//返回湿度
    237          	#else
    238          	SHT11.Temp = t_C;  //返回温度
   \                     ??SHT11_Real_Data_3:
   \   000138   90....       MOV     DPTR,#SHT11 + 4
   \   00013B   78..         MOV     R0,#?V0 + 8
   \   00013D   12....       LCALL   ?L_MOV_TO_X
    239          	SHT11.Humi = rh_true;//返回湿度
   \   000140   A3           INC     DPTR
   \   000141   78..         MOV     R0,#?V0 + 4
   \   000143   12....       LCALL   ?L_MOV_TO_X
    240          	#endif
    241          	
    242          }
   \   000146   7F10         MOV     R7,#0x10
   \   000148   02....       LJMP    ?BANKED_LEAVE_XDATA
    243          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    244          void SHT11_Finish(void)
   \                     SHT11_Finish:
    245          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 0
    246          #ifdef SHT11_DATA_FLOAT
    247          	unsigned int temp;//中间变量
    248          #endif
    249          	if(flag == 0)
   \   000005   90....       MOV     DPTR,#flag
   \   000008   E0           MOVX    A,@DPTR
   \   000009   7009         JNZ     ??SHT11_Finish_0
    250          		{
    251                          //执行一次初始化
    252          		SHT11_Init();
   \   00000B   53F33F       ANL     0xf3,#0x3f
   \   00000E   43FDC0       ORL     0xfd,#0xc0
    253          		flag =1;
   \   000011   7401         MOV     A,#0x1
   \   000013   F0           MOVX    @DPTR,A
    254          		}
    255          	SHT11_Real_Data();//获取数据
   \                     ??SHT11_Finish_0:
   \   000014                ; Setup parameters for call to function SHT11_Real_Data
   \   000014   12....       LCALL   ??SHT11_Real_Data?relay
    256          	SHT11_Delay_Ms(100);
   \   000017                ; Setup parameters for call to function SHT11_Delay_Ms
   \   000017   7964         MOV     R1,#0x64
   \   000019   12....       LCALL   ??SHT11_Delay_Ms?relay
    257          #ifndef SHT11_DATA_FLOAT
    258          /*--------温度转换字符------------*/
    259          if(SHT11.Temp/100 !=0)
    260          	{
    261          	SHT11.Temp_s[0]=SHT11.Temp/100+0x30;//百位
    262          	SHT11.Temp_s[1]=SHT11.Temp%100/10+0x30;
    263          	SHT11.Temp_s[2]=SHT11.Temp%10+0x30;
    264          	SHT11.Temp_s[3]='\0';
    265          	SHT11.length_temp=3;
    266          	}
    267          else
    268          	{
    269          	if(SHT11.Temp%100/10 !=0)//十位不为0
    270          		{
    271          		SHT11.Temp_s[0]=SHT11.Temp/10+0x30;//十位
    272          		SHT11.Temp_s[1]=SHT11.Temp%10+0x30;//个位
    273          		SHT11.Temp_s[2]='\0';
    274          		SHT11.length_temp=2;
    275          		}
    276          	else
    277          		{
    278          		SHT11.Temp_s[0]=SHT11.Temp+0x30;//个位
    279          		SHT11.Temp_s[1]='\0';
    280          		SHT11.length_temp=1;
    281          		}
    282          	
    283          	}
    284          /*--------------湿度转换字符串-------------*/
    285          	if(SHT11.Humi/100 !=0)
    286          		{
    287          			SHT11.Humi_s[0]=SHT11.Humi/100+0x30;//百位
    288          			SHT11.Humi_s[1]=SHT11.Humi%100/10+0x30;
    289          			SHT11.Humi_s[2]=SHT11.Humi%10+0x30;
    290          			SHT11.Humi_s[3]='\0';
    291          			SHT11.length_humi=3;
    292          		}
    293          	else
    294          		{
    295          			if(SHT11.Humi%100/10 !=0)
    296          				{
    297          				SHT11.Humi_s[0]=SHT11.Humi/10+0x30;
    298          				SHT11.Humi_s[1]=SHT11.Humi%10+0x30;
    299          				SHT11.Humi_s[3]='\0';
    300          				SHT11.length_humi=2;
    301          				}
    302          			else
    303          				{
    304          				SHT11.Humi_s[0]=SHT11.Humi+0X30;
    305          				SHT11.Humi_s[1]='\0';
    306          				SHT11.length_humi=1;
    307          				}
    308          		}
    309          #else
    310          
    311          /*--------温度转换字符------------*/
    312          	temp = (unsigned int)(SHT11.Temp*10);//记录小数点下一位
   \   00001C   90....       MOV     DPTR,#SHT11 + 4
   \   00001F   78..         MOV     R0,#?V0 + 0
   \   000021   12....       LCALL   ?L_MOV_X
   \   000024   90....       MOV     DPTR,#__Constant_41200000
   \   000027   78..         MOV     R0,#?V0 + 4
   \   000029   12....       LCALL   ?L_MOV_X
   \   00002C   78..         MOV     R0,#?V0 + 0
   \   00002E   79..         MOV     R1,#?V0 + 4
   \   000030   12....       LCALL   ?FLT_MUL
   \   000033   78..         MOV     R0,#?V0 + 0
   \   000035   12....       LCALL   ?FLT_TO_L
    313          #ifdef SHT11_DATA_BYTE
    314                  SHT11.Temp_byte[0]=(temp>>8)&0xff;
   \   000038   E5..         MOV     A,?V0 + 1
   \   00003A   90....       MOV     DPTR,#SHT11
   \   00003D   F0           MOVX    @DPTR,A
    315                  SHT11.Temp_byte[1]=temp&0xff;
   \   00003E   E5..         MOV     A,?V0 + 0
   \   000040   A3           INC     DPTR
   \   000041   F0           MOVX    @DPTR,A
    316          #else
    317          	if(temp/1000 !=0)//百位不为0
    318          		{
    319          		SHT11.Temp_s[0]=temp/1000+0x30;//百位
    320          		SHT11.Temp_s[1]=temp%1000/100+0x30;//十位
    321          		SHT11.Temp_s[2]=temp%100/10+0x30;//个位
    322          		SHT11.Temp_s[3]=0x2E;
    323          		SHT11.Temp_s[4]=temp%10+0x30;//小数后一位
    324          		SHT11.Temp_s[5]='\0';
    325          		SHT11.length_temp=5;
    326          		}
    327          	else
    328          	{
    329          		if(temp/100 !=0)//十位不为0
    330          		{
    331          		SHT11.Temp_s[0]=temp/100+0x30;//十位
    332          		SHT11.Temp_s[1]=temp%100/10+0x30;//个位
    333          		SHT11.Temp_s[2]=0x2E;
    334          		SHT11.Temp_s[3]=temp%10+0x30;//小数后一位
    335          		SHT11.Temp_s[4]='\0';
    336          		SHT11.length_temp=4;
    337          		}
    338          		else
    339          		{
    340          		SHT11.Temp_s[0]=temp/10+0x30;//个位
    341          		SHT11.Temp_s[1]=0x2E;
    342          		SHT11.Temp_s[2]=temp%10+0x30;//小数后一位
    343          		SHT11.Temp_s[3]='\0';
    344          		SHT11.length_temp=3;
    345          		}
    346          	}
    347          #endif
    348          /*--------------湿度转换字符串-------------*/
    349          	temp=(unsigned int)(SHT11.Humi*10);
   \   000042   90....       MOV     DPTR,#SHT11 + 8
   \   000045   78..         MOV     R0,#?V0 + 0
   \   000047   12....       LCALL   ?L_MOV_X
   \   00004A   90....       MOV     DPTR,#__Constant_41200000
   \   00004D   78..         MOV     R0,#?V0 + 4
   \   00004F   12....       LCALL   ?L_MOV_X
   \   000052   78..         MOV     R0,#?V0 + 0
   \   000054   79..         MOV     R1,#?V0 + 4
   \   000056   12....       LCALL   ?FLT_MUL
   \   000059   78..         MOV     R0,#?V0 + 0
   \   00005B   12....       LCALL   ?FLT_TO_L
    350          #ifdef SHT11_DATA_BYTE
    351                  SHT11.Humi_byte[0]=(temp>>8)&0xff;
   \   00005E   E5..         MOV     A,?V0 + 1
   \   000060   90....       MOV     DPTR,#SHT11 + 2
   \   000063   F0           MOVX    @DPTR,A
    352                  SHT11.Humi_byte[1]=temp&0xff;
   \   000064   E5..         MOV     A,?V0 + 0
   \   000066   A3           INC     DPTR
   \   000067   F0           MOVX    @DPTR,A
    353          #else
    354          	if(temp/1000 !=0)
    355          		{
    356          		SHT11.Humi_s[0]=temp/1000+0x30;//百位
    357          		SHT11.Humi_s[1]=temp%1000/100+0x30;//十位
    358          		SHT11.Humi_s[2]=temp%100/10+0x30;//个位
    359          		SHT11.Humi_s[3]=0x2E;
    360          		SHT11.Humi_s[4]=temp%10+0x30;//小数后一位
    361          		SHT11.Humi_s[5]='\0';
    362          		SHT11.length_humi=5;
    363          		}
    364          	else
    365          		{
    366          		if(temp/100 !=0)//十位不为0
    367          			{
    368          			SHT11.Humi_s[0]=temp/100+0x30;//十位
    369          			SHT11.Humi_s[1]=temp%100/10+0x30;//个位
    370          			SHT11.Humi_s[2]=0x2E;
    371          			SHT11.Humi_s[3]=temp%10+0x30;//小数后一位
    372          			SHT11.Humi_s[4]='\0';
    373          			SHT11.length_humi=4;
    374          			}
    375          		else
    376          			{
    377          			SHT11.Humi_s[0]=temp/10+0x30;//个位
    378          			SHT11.Humi_s[1]=0x2E;
    379          			SHT11.Humi_s[2]=temp%10+0x30;//小数后一位
    380          			SHT11.Humi_s[3]='\0';
    381          			SHT11.length_humi=3;
    382          			}
    383          		}
    384          #endif
    385          #endif
    386          }
   \   000068   7F08         MOV     R7,#0x8
   \   00006A   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   00006D                REQUIRE P0SEL
   \   00006D                REQUIRE P0DIR

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_3c23d70a:
   \   000000   0AD7233C     DD 3C23D70AH

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_c21e6666:
   \   000000   66661EC2     DD 0C21E6666H

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_41700000:
   \   000000   00007041     DD 41700000H

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_0:
   \   000000   00000000     DD 0H

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_c1c80000:
   \   000000   0000C8C1     DD 0C1C80000H

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_38a7c5ac:
   \   000000   ACC5A738     DD 38A7C5ACH

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_b5d624f6:
   \   000000   F624D6B5     DD 0B5D624F6H

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_3d1652bd:
   \   000000   BD52163D     DD 3D1652BDH

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_c002fec5:
   \   000000   C5FE02C0     DD 0C002FEC5H

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_42c80001:
   \   000000   0100C842     DD 42C80001H

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_42c80000:
   \   000000   0000C842     DD 42C80000H

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_3dcccccd:
   \   000000   CDCCCC3D     DD 3DCCCCCDH

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_41200000:
   \   000000   00002041     DD 41200000H

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Delay?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Delay

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Delay_Ms?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Delay_Ms

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Start?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Start

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Reset?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Reset

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Write_Byte?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Write_Byte

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Read_Byte?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Read_Byte

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Order?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Order

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Get_Data?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Get_Data

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Real_Data?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Real_Data

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Finish?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Finish
    387          

   Maximum stack usage in bytes:

     Function              ISTACK PSTACK XSTACK
     --------              ------ ------ ------
     SHT11_Delay               0      0     14
     SHT11_Delay_Ms            0      0     25
       -> SHT11_Delay          0      0     18
       -> SHT11_Delay          0      0     18
       -> SHT11_Delay          0      0     18
       -> SHT11_Delay          0      0     18
     SHT11_Finish              0      0     16
       -> SHT11_Real_Data      0      0     32
       -> SHT11_Delay_Ms       0      0     32
     SHT11_Get_Data            1      0     38
       -> SHT11_Reset          0      0     28
       -> SHT11_Order          0      0     28
       -> SHT11_Delay          0      0     28
       -> SHT11_Read_Byte      0      0     28
       -> SHT11_Read_Byte      0      0     28
       -> SHT11_Read_Byte      0      0     28
       -> SHT11_Reset          0      0     28
       -> SHT11_Delay_Ms       0      0     28
       -> SHT11_Order          0      0     28
       -> SHT11_Delay          0      0     28
       -> SHT11_Read_Byte      0      0     28
       -> SHT11_Read_Byte      0      0     28
       -> SHT11_Read_Byte      0      0     28
     SHT11_Order               0      0     24
       -> SHT11_Write_Byte     0      0     20
       -> SHT11_Write_Byte     0      0     20
       -> SHT11_Delay          0      0     20
       -> SHT11_Delay          0      0     20
       -> SHT11_Reset          0      0     20
     SHT11_Read_Byte           0      0     23
       -> SHT11_Delay          0      0     18
       -> SHT11_Delay          0      0     18
     SHT11_Real_Data           4      0     40
       -> SHT11_Get_Data       0      0     48
     SHT11_Reset               2      0     14
       -> SHT11_Start          4      0      0
     SHT11_Start               2      0      0
       -> SHT11_Delay          4      0      0
       -> SHT11_Delay          4      0      0
       -> SHT11_Delay          4      0      0
     SHT11_Write_Byte          0      0     19
       -> SHT11_Delay          0      0     18


   Segment part sizes:

     Function/Label           Bytes
     --------------           -----
     _A_P0                       1
     P0SEL                       1
     P0DIR                       1
     SHT11                      26
     flag                        1
     SHT11_Delay                18
     SHT11_Delay_Ms             19
     ?Subroutine1                5
     ?Subroutine3               11
     SHT11_Start                38
     ?Subroutine0                7
     SHT11_Reset                29
     SHT11_Write_Byte           64
     SHT11_Read_Byte            81
     SHT11_Order                71
     SHT11_Get_Data            117
     ?Subroutine5               13
     ?Subroutine4               21
     ?Subroutine2               21
     SHT11_Real_Data           331
     SHT11_Finish              109
     __Constant_3c23d70a         4
     __Constant_c21e6666         4
     __Constant_41700000         4
     __Constant_0                4
     __Constant_c1c80000         4
     __Constant_38a7c5ac         4
     __Constant_b5d624f6         4
     __Constant_3d1652bd         4
     __Constant_c002fec5         4
     __Constant_42c80001         4
     __Constant_42c80000         4
     __Constant_3dcccccd         4
     __Constant_41200000         4
     ??SHT11_Delay?relay         6
     ??SHT11_Delay_Ms?relay      6
     ??SHT11_Start?relay         6
     ??SHT11_Reset?relay         6
     ??SHT11_Write_Byte?relay    6
     ??SHT11_Read_Byte?relay     6
     ??SHT11_Order?relay         6
     ??SHT11_Get_Data?relay      6
     ??SHT11_Real_Data?relay     6
     ??SHT11_Finish?relay        6

 
 955 bytes in segment BANKED_CODE
  60 bytes in segment BANK_RELAYS
   3 bytes in segment SFR_AN
  52 bytes in segment XDATA_ROM_C
  27 bytes in segment XDATA_Z
 
 1 015 bytes of CODE  memory
     0 bytes of CONST memory (+ 52 bytes shared)
     0 bytes of DATA  memory (+  3 bytes shared)
    27 bytes of XDATA memory

Errors: none
Warnings: none
