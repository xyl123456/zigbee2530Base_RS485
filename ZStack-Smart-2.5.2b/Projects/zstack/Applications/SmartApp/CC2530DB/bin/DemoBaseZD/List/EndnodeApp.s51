///////////////////////////////////////////////////////////////////////////////
//                                                                            /
// IAR C/C++ Compiler V8.10.1.10194/W32 for 8051        25/Nov/2016  10:40:49 /
// Copyright 2004-2011 IAR Systems AB.                                        /
//                                                                            /
//    Core               =  plain                                             /
//    Code model         =  banked                                            /
//    Data model         =  large                                             /
//    Calling convention =  xdata reentrant                                   /
//    Constant location  =  data_rom                                          /
//    Dptr setup         =  1,16                                              /
//    Source file        =  E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\Source\Device\EndnodeApp. /
//                          c                                                 /
//    Command line       =  -f E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zs /
//                          tack\Applications\SmartApp\CC2530DB\Devices\..\.. /
//                          \..\..\Tools\CC2530DB\f8wEndev.cfg (-DCPU32MHZ    /
//                          -DROOT=__near_func -DMAC_CFG_TX_DATA_MAX=3        /
//                          -DMAC_CFG_TX_MAX=6 -DMAC_CFG_RX_MAX=3             /
//                          -DSSA_ENDNODE) -f E:\work\zigbee\ZStack-Smart-2.5 /
//                          .2b\Projects\zstack\Applications\SmartApp\CC2530D /
//                          B\Devices\..\..\..\..\Tools\CC2530DB\f8wConfig.cf /
//                          g (-DZIGBEEPRO -DSECURE=1 -DZG_SECURE_DYNAMIC=1   /
//                          -DREFLECTOR -DDEFAULT_CHANLIST=0x00000800         /
//                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                      /
//                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_M /
//                          ASK=0x007F -DBEACON_REQUEST_DELAY=100             /
//                          -DBEACON_REQ_DELAY_MASK=0x00FF                    /
//                          -DLINK_STATUS_JITTER_MASK=0x007F                  /
//                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_P /
//                          OLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7           /
//                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3   /
//                          -DNWK_MAX_DATA_RETRIES=2                          /
//                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9        /
//                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40          /
//                          -DNWK_MAX_BINDING_ENTRIES=4                       /
//                          -DMAX_BINDING_CLUSTER_IDS=4                       /
//                          "-DDEFAULT_KEY={0x01, 0x03, 0x05, 0x07, 0x09,     /
//                          0x0B, 0x0D, 0x0F, 0x00, 0x02, 0x04, 0x06, 0x08,   /
//                          0x0A, 0x0C, 0x0D}" -DMAC_MAX_FRAME_SIZE=116       /
//                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const    /
//                          __code" -DGENERIC=__generic                       /
//                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=600        /
//                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)  /
//                          -DREJOIN_POLL_RATE=440 E:\work\zigbee\ZStack-Smar /
//                          t-2.5.2b\Projects\zstack\Applications\SmartApp\So /
//                          urce\Device\EndnodeApp.c -D SECURE=1 -D ZTOOL_P1  /
//                          -D DEVICE_TYPE_ID=0xFE -D                         /
//                          SIGNAL_AMPLIFIER_SETTING -D xNWK_AUTO_POLL -D     /
//                          xHAL_UART_DMA=2 -D xHAL_UART_DMA_ALT1 -D          /
//                          xJIAJU_BUILDIN -D MT_TASK -D MT_SYS_FUNC -D       /
//                          MT_ZDO_FUNC -D NV_INIT -D NV_RESTORE -lC          /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\bin\DemoBaseZD\L /
//                          ist\ -lA E:\work\zigbee\ZStack-Smart-2.5.2b\Proje /
//                          cts\zstack\Applications\SmartApp\CC2530DB\bin\Dem /
//                          oBaseZD\List\ --diag_suppress Pe001,Pa010 -o      /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\bin\DemoBaseZD\O /
//                          bj\ -e --debug --core=plain --dptr=16,1           /
//                          --data_model=large --code_model=banked            /
//                          --calling_convention=xdata_reentrant              /
//                          --place_constants=data_rom --nr_virtual_regs 16   /
//                          -I E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zs /
//                          tack\Applications\SmartApp\CC2530DB\Devices\ -I   /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\So /
//                          urce\Common\ -I E:\work\zigbee\ZStack-Smart-2.5.2 /
//                          b\Projects\zstack\Applications\SmartApp\CC2530DB\ /
//                          Devices\..\..\Source\Connector\ -I                /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\So /
//                          urce\\EndNode\ -I E:\work\zigbee\ZStack-Smart-2.5 /
//                          .2b\Projects\zstack\Applications\SmartApp\CC2530D /
//                          B\Devices\..\..\Source\Board\ -I                  /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\So /
//                          urce\Manage\ -I E:\work\zigbee\ZStack-Smart-2.5.2 /
//                          b\Projects\zstack\Applications\SmartApp\CC2530DB\ /
//                          Devices\..\..\Source\Manage\Callbacks\ -I         /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\So /
//                          urce\Manage\debug\ -I E:\work\zigbee\ZStack-Smart /
//                          -2.5.2b\Projects\zstack\Applications\SmartApp\CC2 /
//                          530DB\Devices\..\..\Source\Manage\HeartBeat\ -I   /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\So /
//                          urce\Manage\incode\ -I E:\work\zigbee\ZStack-Smar /
//                          t-2.5.2b\Projects\zstack\Applications\SmartApp\CC /
//                          2530DB\Devices\..\..\..\..\ZMain\TI2530DB\ -I     /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\hal\include\ -I              /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\hal\target\CC2530EB\ -I      /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\mac\include\ -I              /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\mac\high_level\ -I           /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\mac\low_level\srf04\ -I      /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\mac\low_level\srf04\single_c /
//                          hip\ -I E:\work\zigbee\ZStack-Smart-2.5.2b\Projec /
//                          ts\zstack\Applications\SmartApp\CC2530DB\Devices\ /
//                          ..\..\..\..\..\..\Components\mt\ -I               /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\osal\include\ -I             /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\services\saddr\ -I           /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\services\sdata\ -I           /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\stack\af\ -I                 /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\stack\nwk\ -I                /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\stack\sapi\ -I               /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\stack\sec\ -I                /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\stack\sys\ -I                /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\stack\zdo\ -I                /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\zmac\ -I                     /
//                          E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\Devices\..\..\.. /
//                          \..\..\..\Components\zmac\f8w\ -Oh                /
//                          --require_prototypes                              /
//    List file          =  E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstac /
//                          k\Applications\SmartApp\CC2530DB\bin\DemoBaseZD\L /
//                          ist\EndnodeApp.s51                                /
//                                                                            /
//                                                                            /
///////////////////////////////////////////////////////////////////////////////

        NAME EndnodeApp

        RTMODEL "__SystemLibrary", "CLib"
        RTMODEL "__calling_convention", "xdata_reentrant"
        RTMODEL "__code_model", "banked"
        RTMODEL "__core", "plain"
        RTMODEL "__data_model", "large"
        RTMODEL "__dptr_size", "16"
        RTMODEL "__extended_stack", "disabled"
        RTMODEL "__location_for_constants", "data"
        RTMODEL "__number_of_dptrs", "1"
        RTMODEL "__rt_version", "1"

        RSEG DOVERLAY:DATA:NOROOT(0)
        RSEG IOVERLAY:IDATA:NOROOT(0)
        RSEG ISTACK:IDATA:NOROOT(0)
        RSEG PSTACK:XDATA:NOROOT(0)
        RSEG XSTACK:XDATA:NOROOT(0)

        EXTERN ?ALLOC_XSTACK8
        EXTERN ?BANKED_ENTER_XDATA
        EXTERN ?BANKED_LEAVE_XDATA
        EXTERN ?BDISPATCH
        EXTERN ?DEALLOC_XSTACK8
        EXTERN ?PUSH_XSTACK_I_ONE
        EXTERN ?PUSH_XSTACK_I_THREE
        EXTERN ?PUSH_XSTACK_I_TWO
        EXTERN ?V0
        EXTERN ?XSP
        EXTERN ?XSTACK_DISP0_8

        PUBLIC ??CommonApp_HandleCombineKeys?relay
        FUNCTION ??CommonApp_HandleCombineKeys?relay,0203H
        PUBLIC ??CommonApp_InitConfirm?relay
        FUNCTION ??CommonApp_InitConfirm?relay,0203H
        PUBLIC ??CommonApp_MessageMSGCB?relay
        FUNCTION ??CommonApp_MessageMSGCB?relay,0203H
        PUBLIC ??CommonApp_ProcessZDOStates?relay
        FUNCTION ??CommonApp_ProcessZDOStates?relay,0203H
        PUBLIC CommonApp_HandleCombineKeys
        FUNCTION CommonApp_HandleCombineKeys,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        PUBLIC CommonApp_InitConfirm
        FUNCTION CommonApp_InitConfirm,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        PUBLIC CommonApp_MessageMSGCB
        FUNCTION CommonApp_MessageMSGCB,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 26, STACK
        PUBLIC CommonApp_ProcessZDOStates
        FUNCTION CommonApp_ProcessZDOStates,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        PUBWEAK WDCTL
        
        CFI Names cfiNames0
        CFI StackFrame CFA_SP SP IDATA
        CFI StackFrame CFA_PSP16 PSP16 XDATA
        CFI StackFrame CFA_XSP16 XSP16 XDATA
        CFI StaticOverlayFrame CFA_IOVERLAY IOVERLAY
        CFI StaticOverlayFrame CFA_DOVERLAY DOVERLAY
        CFI Resource `PSW.CY`:1, `B.BR0`:1, `B.BR1`:1, `B.BR2`:1, `B.BR3`:1
        CFI Resource `B.BR4`:1, `B.BR5`:1, `B.BR6`:1, `B.BR7`:1, `VB.BR8`:1
        CFI Resource `VB.BR9`:1, `VB.BR10`:1, `VB.BR11`:1, `VB.BR12`:1
        CFI Resource `VB.BR13`:1, `VB.BR14`:1, `VB.BR15`:1, VB:8, B:8, A:8
        CFI Resource PSW:8, DPL0:8, DPH0:8, R0:8, R1:8, R2:8, R3:8, R4:8, R5:8
        CFI Resource R6:8, R7:8, V0:8, V1:8, V2:8, V3:8, V4:8, V5:8, V6:8, V7:8
        CFI Resource V8:8, V9:8, V10:8, V11:8, V12:8, V13:8, V14:8, V15:8, SP:8
        CFI Resource PSPH:8, PSPL:8, PSP16:16, XSPH:8, XSPL:8, XSP16:16
        CFI VirtualResource ?RET:24
        CFI Resource ?BRET_EXT:8
        CFI VirtualResource ?RET_HIGH:8, ?RET_LOW:8
        CFI ResourceParts PSP16 PSPH, PSPL
        CFI ResourceParts XSP16 XSPH, XSPL
        CFI ResourceParts ?RET ?BRET_EXT, ?RET_HIGH, ?RET_LOW
        CFI EndNames cfiNames0
        
        CFI Common cfiCommon0 Using cfiNames0
        CFI CodeAlign 1
        CFI DataAlign -1
        CFI ReturnAddress ?RET CODE
        CFI CFA_DOVERLAY Used
        CFI CFA_IOVERLAY Used
        CFI CFA_SP SP+-3
        CFI CFA_PSP16 PSP16+0
        CFI CFA_XSP16 XSP16+0
        CFI `PSW.CY` SameValue
        CFI `B.BR0` SameValue
        CFI `B.BR1` SameValue
        CFI `B.BR2` SameValue
        CFI `B.BR3` SameValue
        CFI `B.BR4` SameValue
        CFI `B.BR5` SameValue
        CFI `B.BR6` SameValue
        CFI `B.BR7` SameValue
        CFI `VB.BR8` SameValue
        CFI `VB.BR9` SameValue
        CFI `VB.BR10` SameValue
        CFI `VB.BR11` SameValue
        CFI `VB.BR12` SameValue
        CFI `VB.BR13` SameValue
        CFI `VB.BR14` SameValue
        CFI `VB.BR15` SameValue
        CFI VB SameValue
        CFI B Undefined
        CFI A Undefined
        CFI PSW SameValue
        CFI DPL0 SameValue
        CFI DPH0 SameValue
        CFI R0 Undefined
        CFI R1 Undefined
        CFI R2 Undefined
        CFI R3 Undefined
        CFI R4 Undefined
        CFI R5 Undefined
        CFI R6 SameValue
        CFI R7 SameValue
        CFI V0 SameValue
        CFI V1 SameValue
        CFI V2 SameValue
        CFI V3 SameValue
        CFI V4 SameValue
        CFI V5 SameValue
        CFI V6 SameValue
        CFI V7 SameValue
        CFI V8 SameValue
        CFI V9 SameValue
        CFI V10 SameValue
        CFI V11 SameValue
        CFI V12 SameValue
        CFI V13 SameValue
        CFI V14 SameValue
        CFI V15 SameValue
        CFI PSPH Undefined
        CFI PSPL Undefined
        CFI XSPH Undefined
        CFI XSPL Undefined
        CFI ?RET Concat
        CFI ?BRET_EXT Frame(CFA_SP, 3)
        CFI ?RET_HIGH Frame(CFA_SP, 2)
        CFI ?RET_LOW Frame(CFA_SP, 1)
        CFI EndCommon cfiCommon0
        
        
        CFI Common cfiCommon1 Using cfiNames0
        CFI CodeAlign 1
        CFI DataAlign -1
        CFI ReturnAddress ?RET CODE
        CFI CFA_DOVERLAY Used
        CFI CFA_IOVERLAY Used
        CFI CFA_SP SP+-2
        CFI CFA_PSP16 PSP16+0
        CFI CFA_XSP16 XSP16+0
        CFI `PSW.CY` SameValue
        CFI `B.BR0` SameValue
        CFI `B.BR1` SameValue
        CFI `B.BR2` SameValue
        CFI `B.BR3` SameValue
        CFI `B.BR4` SameValue
        CFI `B.BR5` SameValue
        CFI `B.BR6` SameValue
        CFI `B.BR7` SameValue
        CFI `VB.BR8` SameValue
        CFI `VB.BR9` SameValue
        CFI `VB.BR10` SameValue
        CFI `VB.BR11` SameValue
        CFI `VB.BR12` SameValue
        CFI `VB.BR13` SameValue
        CFI `VB.BR14` SameValue
        CFI `VB.BR15` SameValue
        CFI VB SameValue
        CFI B SameValue
        CFI A SameValue
        CFI PSW SameValue
        CFI DPL0 SameValue
        CFI DPH0 SameValue
        CFI R0 SameValue
        CFI R1 SameValue
        CFI R2 SameValue
        CFI R3 SameValue
        CFI R4 SameValue
        CFI R5 SameValue
        CFI R6 SameValue
        CFI R7 SameValue
        CFI V0 SameValue
        CFI V1 SameValue
        CFI V2 SameValue
        CFI V3 SameValue
        CFI V4 SameValue
        CFI V5 SameValue
        CFI V6 SameValue
        CFI V7 SameValue
        CFI V8 SameValue
        CFI V9 SameValue
        CFI V10 SameValue
        CFI V11 SameValue
        CFI V12 SameValue
        CFI V13 SameValue
        CFI V14 SameValue
        CFI V15 SameValue
        CFI PSPH Undefined
        CFI PSPL Undefined
        CFI XSPH Undefined
        CFI XSPL Undefined
        CFI ?RET Concat
        CFI ?BRET_EXT SameValue
        CFI ?RET_HIGH Frame(CFA_SP, 2)
        CFI ?RET_LOW Frame(CFA_SP, 1)
        CFI EndCommon cfiCommon1
        
osal_nv_item_init   SYMBOL "osal_nv_item_init"
osal_nv_read        SYMBOL "osal_nv_read"
CommonApp_PermitJoiningRequest SYMBOL "CommonApp_PermitJoiningRequest"
ZDOInitDevice       SYMBOL "ZDOInitDevice"
osal_memcpy         SYMBOL "osal_memcpy"
crc_confirm         SYMBOL "crc_confirm"
rs485_address       SYMBOL "rs485_address"
rs485_changeAddr    SYMBOL "rs485_changeAddr"
rs485_control       SYMBOL "rs485_control"
rs485_state         SYMBOL "rs485_state"
NLME_GetShortAddr   SYMBOL "NLME_GetShortAddr"
RS485_HeartBeatCB   SYMBOL "RS485_HeartBeatCB"
set_user_event      SYMBOL "set_user_event"
HalStatesInit       SYMBOL "HalStatesInit"
HalLedBlink         SYMBOL "HalLedBlink"
osal_nv_write       SYMBOL "osal_nv_write"
zgWriteStartupOptions SYMBOL "zgWriteStartupOptions"
??CommonApp_PermitJoiningRequest?relay SYMBOL "?relay", CommonApp_PermitJoiningRequest
??HalLedBlink?relay SYMBOL "?relay", HalLedBlink
??HalStatesInit?relay SYMBOL "?relay", HalStatesInit
??NLME_GetShortAddr?relay SYMBOL "?relay", NLME_GetShortAddr
??RS485_HeartBeatCB?relay SYMBOL "?relay", RS485_HeartBeatCB
??ZDOInitDevice?relay SYMBOL "?relay", ZDOInitDevice
??crc_confirm?relay SYMBOL "?relay", crc_confirm
??osal_memcpy?relay SYMBOL "?relay", osal_memcpy
??osal_nv_item_init?relay SYMBOL "?relay", osal_nv_item_init
??osal_nv_read?relay SYMBOL "?relay", osal_nv_read
??osal_nv_write?relay SYMBOL "?relay", osal_nv_write
??rs485_address?relay SYMBOL "?relay", rs485_address
??rs485_changeAddr?relay SYMBOL "?relay", rs485_changeAddr
??rs485_control?relay SYMBOL "?relay", rs485_control
??rs485_state?relay SYMBOL "?relay", rs485_state
??set_user_event?relay SYMBOL "?relay", set_user_event
??zgWriteStartupOptions?relay SYMBOL "?relay", zgWriteStartupOptions
CommonApp_HandleCombineKeys SYMBOL "CommonApp_HandleCombineKeys"
??CommonApp_HandleCombineKeys?relay SYMBOL "?relay", CommonApp_HandleCombineKeys
CommonApp_InitConfirm SYMBOL "CommonApp_InitConfirm"
??CommonApp_InitConfirm?relay SYMBOL "?relay", CommonApp_InitConfirm
CommonApp_MessageMSGCB SYMBOL "CommonApp_MessageMSGCB"
??CommonApp_MessageMSGCB?relay SYMBOL "?relay", CommonApp_MessageMSGCB
CommonApp_ProcessZDOStates SYMBOL "CommonApp_ProcessZDOStates"
??CommonApp_ProcessZDOStates?relay SYMBOL "?relay", CommonApp_ProcessZDOStates

        EXTERN osal_nv_item_init
        FUNCTION osal_nv_item_init,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 13, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_nv_read
        FUNCTION osal_nv_read,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN CommonApp_PermitJoiningRequest
        FUNCTION CommonApp_PermitJoiningRequest,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN ZDOInitDevice
        FUNCTION ZDOInitDevice,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_memcpy
        FUNCTION osal_memcpy,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 26, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN crc_confirm
        FUNCTION crc_confirm,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN rs485_address
        FUNCTION rs485_address,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN rs485_changeAddr
        FUNCTION rs485_changeAddr,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN rs485_control
        FUNCTION rs485_control,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN rs485_state
        FUNCTION rs485_state,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN NLME_GetShortAddr
        FUNCTION NLME_GetShortAddr,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN RS485_HeartBeatCB
        FUNCTION RS485_HeartBeatCB,0602H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN set_user_event
        FUNCTION set_user_event,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN HalStatesInit
        FUNCTION HalStatesInit,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN HalLedBlink
        FUNCTION HalLedBlink,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_nv_write
        FUNCTION osal_nv_write,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zgWriteStartupOptions
        FUNCTION zgWriteStartupOptions,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN ??CommonApp_PermitJoiningRequest?relay
        FUNCTION ??CommonApp_PermitJoiningRequest?relay,00H
        EXTERN ??HalLedBlink?relay
        FUNCTION ??HalLedBlink?relay,00H
        EXTERN ??HalStatesInit?relay
        FUNCTION ??HalStatesInit?relay,00H
        EXTERN ??NLME_GetShortAddr?relay
        FUNCTION ??NLME_GetShortAddr?relay,00H
        EXTERN ??RS485_HeartBeatCB?relay
        FUNCTION ??RS485_HeartBeatCB?relay,00H
        EXTERN ??ZDOInitDevice?relay
        FUNCTION ??ZDOInitDevice?relay,00H
        EXTERN ??crc_confirm?relay
        FUNCTION ??crc_confirm?relay,00H
        EXTERN ??osal_memcpy?relay
        FUNCTION ??osal_memcpy?relay,00H
        EXTERN ??osal_nv_item_init?relay
        FUNCTION ??osal_nv_item_init?relay,00H
        EXTERN ??osal_nv_read?relay
        FUNCTION ??osal_nv_read?relay,00H
        EXTERN ??osal_nv_write?relay
        FUNCTION ??osal_nv_write?relay,00H
        EXTERN ??rs485_address?relay
        FUNCTION ??rs485_address?relay,00H
        EXTERN ??rs485_changeAddr?relay
        FUNCTION ??rs485_changeAddr?relay,00H
        EXTERN ??rs485_control?relay
        FUNCTION ??rs485_control?relay,00H
        EXTERN ??rs485_state?relay
        FUNCTION ??rs485_state?relay,00H
        EXTERN ??set_user_event?relay
        FUNCTION ??set_user_event?relay,00H
        EXTERN ??zgWriteStartupOptions?relay
        FUNCTION ??zgWriteStartupOptions?relay,00H
        EXTERN Address_dev
        EXTERN CommonApp_TaskID
        EXTERN devState
        EXTERN isPermitJoining
        EXTERN nwkAddr

// E:\work\zigbee\ZStack-Smart-2.5.2b\Projects\zstack\Applications\SmartApp\Source\Device\EndnodeApp.c
//    1 /**************************************************************************************************
//    2   Filename:       EndnodeApp.c
//    3   Revised:        $Date: 2014-04-16 18:34:36 -0800 (Wed, 16 Apr 2014) $
//    4   Revision:       $Revision: 29217 $
//    5 
//    6   Description:    End Node Application
//    7 **************************************************************************************************/
//    8 
//    9 /**************************************************************************************************
//   10 Modify by Sam_Chen
//   11 Date:2015-07-31
//   12 **************************************************************************************************/
//   13 
//   14 /*********************************************************************
//   15  * INCLUDES
//   16  */
//   17 #include "OSAL.h"
//   18 #include "AF.h"
//   19 #include "ZDApp.h"
//   20 #include "ZDObject.h"
//   21 #include "ZDProfile.h"
//   22 #include "OSAL_Nv.h"
//   23 #include "OnBoard.h"

        ASEGN SFR_AN:DATA:NOROOT,0c9H
// unsigned char volatile __sfr WDCTL
WDCTL:
        DATA8
        DS 1
//   24 
//   25 #include "ZComDef.h"
//   26 #include "CommonApp.h"
//   27 
//   28 /* HAL */
//   29 #include "hal_lcd.h"
//   30 #include "hal_led.h"
//   31 #include "hal_key.h"
//   32 #include "hal_uart.h"
//   33 
//   34 
//   35 /*********************************************************************
//   36  * MACROS
//   37  */
//   38 
//   39 /*********************************************************************
//   40  * CONSTANTS
//   41  */
//   42 
//   43 /*********************************************************************
//   44  * TYPEDEFS
//   45  */
//   46 
//   47 /*********************************************************************
//   48  * GLOBAL VARIABLES
//   49  */
//   50 
//   51 /*********************************************************************
//   52  * EXTERNAL VARIABLES
//   53  */
//   54 extern const cId_t CommonApp_InClusterList[];
//   55 extern const cId_t CommonApp_OutClusterList[];
//   56 extern const SimpleDescriptionFormat_t CommonApp_SimpleDesc;
//   57 extern endPointDesc_t CommonApp_epDesc;
//   58 
//   59 extern byte CommonApp_TaskID;
//   60 extern devStates_t CommonApp_NwkState;
//   61 extern byte CommonApp_TransID;
//   62 
//   63 extern afAddrType_t CommonApp_DstAddr;
//   64 
//   65 //mac address
//   66 extern ZLongAddr_t macAddr;
//   67 
//   68 extern uint8 SHORT_ADDR_G[4];
//   69 
//   70 extern uint8 EXT_ADDR_G[16];
//   71 
//   72 extern const uint8 f_tail[4];
//   73 
//   74 extern bool isPermitJoining;
//   75 
//   76 /*********************************************************************
//   77  * EXTERNAL FUNCTIONS
//   78  */
//   79 
//   80 /*********************************************************************
//   81  * LOCAL VARIABLES
//   82  */
//   83 static uint8 *fBuf;		//pointer data buffer
//   84 static uint16 fLen;		//buffer data length
//   85 
//   86 /*********************************************************************
//   87  * LOCAL FUNCTIONS
//   88  */
//   89 static void EndNodeApp_HeartBeatEvent(void);
//   90 static void Data_Analysis(uint8 *data, uint16 length);
//   91 #ifdef RS485_DEV
//   92 static void RS485_Analysis(uint8 *data, uint16 length);
//   93 
//   94 #endif
//   95 /*********************************************************************
//   96  * NETWORK LAYER CALLBACKS
//   97  */
//   98 
//   99 /*********************************************************************
//  100  * PUBLIC FUNCTIONS
//  101  */
//  102 
//  103 /*********************************************************************
//  104  * @fn      CommonApp_InitConfirm
//  105  *
//  106  * @brief   Initialization function for the End Node App Task.
//  107  *          This is called during initialization and should contain
//  108  *          any application specific initialization (ie. hardware
//  109  *          initialization/setup, table initialization, power up
//  110  *          notificaiton ... ).
//  111  *
//  112  * @param   task_id - the ID assigned by OSAL.  This ID should be
//  113  *                    used to send messages and set timers.
//  114  *
//  115  * @return  none
//  116  */
//  117 

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  118 void CommonApp_InitConfirm( uint8 task_id )
CommonApp_InitConfirm:
        CFI Block cfiBlock0 Using cfiCommon0
        CFI Function CommonApp_InitConfirm
        CODE
//  119 {
        FUNCALL CommonApp_InitConfirm, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_InitConfirm, osal_nv_read
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_InitConfirm, CommonApp_PermitJoiningRequest
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_InitConfirm, ZDOInitDevice
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 0
//  120 #ifdef RS485_DEV
//  121   //读取NV地址值到存储空间
//  122   osal_nv_item_init(ZCD_DEV_ADDRESS, 1, NULL);
        ; Setup parameters for call to function osal_nv_item_init
        CLR     A
        MOV     ?V0 + 0,A
        MOV     ?V0 + 1,A
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 12)
        MOV     R4,#0x1
        MOV     R5,#0x0
        MOV     R2,#0x2
        MOV     R3,#0x2
        LCALL   ??osal_nv_item_init?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 10)
//  123   osal_nv_read(ZCD_DEV_ADDRESS, 0, 1, &Address_dev);
        ; Setup parameters for call to function osal_nv_read
        MOV     ?V0 + 0,#Address_dev & 0xff
        MOV     ?V0 + 1,#(Address_dev >> 8) & 0xff
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 12)
        MOV     ?V0 + 0,#0x1
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 14)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x2
        MOV     R3,#0x2
        LCALL   ??osal_nv_read?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 10)
//  124 #endif
//  125   CommonApp_PermitJoiningRequest(PERMIT_JOIN_FORBID);
        ; Setup parameters for call to function CommonApp_PermitJoiningRequest
        MOV     R1,#0x0
        LCALL   ??CommonApp_PermitJoiningRequest?relay
//  126   ZDOInitDevice( 0 );
        ; Setup parameters for call to function ZDOInitDevice
        MOV     R2,#0x0
        MOV     R3,#0x0
        LCALL   ??ZDOInitDevice?relay
        CFI EndBlock cfiBlock0
//  127 /* 串口回调中断未定义
//  128 #if(HAL_UART==TRUE)
//  129   SerialTx_Handler(SERIAL_COM_PORT, ConnectorApp_TxHandler);
//  130 #endif
//  131   */
//  132 }
        REQUIRE ?Subroutine0
        ; // Fall through to label ?Subroutine0

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine0:
        CFI Block cfiBlock1 Using cfiCommon0
        CFI NoFunction
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 10)
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        MOV     R7,#0x2
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock1
//  133 
//  134 
//  135 /*********************************************************************
//  136  * LOCAL FUNCTIONS
//  137  */
//  138 
//  139 /*********************************************************************
//  140  * @fn      CommonApp_MessageMSGCB
//  141  *
//  142  * @brief   Data message processor callback.  This function processes
//  143  *          any incoming data - probably from other devices.  So, based
//  144  *          on cluster ID, perform the intended action.
//  145  *
//  146  * @param   none
//  147  *
//  148  * @return  none
//  149  */
//  150 

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  151 void CommonApp_MessageMSGCB( afIncomingMSGPacket_t *pkt )
CommonApp_MessageMSGCB:
        CFI Block cfiBlock2 Using cfiCommon0
        CFI Function CommonApp_MessageMSGCB
        CODE
//  152 {
        FUNCALL CommonApp_MessageMSGCB, osal_memcpy
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 26, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 26, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_MessageMSGCB, crc_confirm
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_MessageMSGCB, rs485_address
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_MessageMSGCB, rs485_changeAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_MessageMSGCB, rs485_control
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_MessageMSGCB, rs485_state
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xf
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 15)
        ; Saved register size: 15
        ; Auto size: 8
        MOV     A,#-0x8
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 23)
//  153   switch ( pkt->clusterId )
        MOV     DPL,R2
        MOV     DPH,R3
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,#0x1
        JNZ     ??CommonApp_MessageMSGCB_0
        INC     DPTR
        MOVX    A,@DPTR
??CommonApp_MessageMSGCB_0:
        JZ      $+5
        LJMP    ??CommonApp_MessageMSGCB_1 & 0xFFFF
//  154   {
//  155     case COMMONAPP_CLUSTERID:
//  156 #ifndef RS485_DEV
//  157       Data_Analysis(pkt->cmd.Data, pkt->cmd.DataLength);
//  158 #else
//  159       RS485_Analysis(pkt->cmd.Data, pkt->cmd.DataLength);
        MOV     A,R2
        ADD     A,#0x20
        MOV     DPL,A
        MOV     A,R3
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R6,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R7,A
        MOV     A,R2
        ADD     A,#0x22
        MOV     DPL,A
        MOV     A,R3
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     ?V0 + 0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     ?V0 + 1,A
        MOV     A,R6
        MOV     ?V0 + 2,A
        ; Setup parameters for call to function osal_memcpy
        MOV     ?V0 + 4,?V0 + 0
        MOV     ?V0 + 5,?V0 + 1
        MOV     ?V0 + 6,#0x0
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_THREE
        CFI CFA_XSP16 add(XSP16, 26)
        MOV     A,R6
        MOV     R4,A
        MOV     A,R7
        MOV     R5,A
        MOV     A,#0x3
        LCALL   ?XSTACK_DISP0_8
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??osal_memcpy?relay
        MOV     A,#0x3
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 23)
        ; Setup parameters for call to function crc_confirm
        MOV     A,R6
        MOV     R1,A
        MOV     R2,?V0 + 0
        MOV     R3,?V0 + 1
        LCALL   ??crc_confirm?relay
        MOV     A,R1
        JZ      ??CommonApp_MessageMSGCB_1
        MOV     A,#0x1
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        ADD     A,#-0x3
        JZ      ??CommonApp_MessageMSGCB_2
        DEC     A
        JZ      ??CommonApp_MessageMSGCB_3
        ADD     A,#-0x2
        JZ      ??CommonApp_MessageMSGCB_4
        ADD     A,#-0x1f
        JNZ     ??CommonApp_MessageMSGCB_1
        ; Setup parameters for call to function rs485_address
        LCALL   ??rs485_address?relay
        SJMP    ??CommonApp_MessageMSGCB_1
??CommonApp_MessageMSGCB_4:
        LCALL   ?Subroutine1 & 0xFFFF
//  160 #endif
//  161       break;
//  162   }
??CrossCallReturnLabel_0:
        JNZ     ??CommonApp_MessageMSGCB_1
        ; Setup parameters for call to function rs485_changeAddr
        MOV     R4,?V0 + 2
        MOV     R5,#0x0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??rs485_changeAddr?relay
        SJMP    ??CommonApp_MessageMSGCB_1
??CommonApp_MessageMSGCB_3:
        LCALL   ?Subroutine1 & 0xFFFF
??CrossCallReturnLabel_1:
        JNZ     ??CommonApp_MessageMSGCB_1
        ; Setup parameters for call to function rs485_control
        MOV     R4,?V0 + 2
        MOV     R5,#0x0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??rs485_control?relay
        SJMP    ??CommonApp_MessageMSGCB_1
??CommonApp_MessageMSGCB_2:
        LCALL   ?Subroutine1 & 0xFFFF
??CrossCallReturnLabel_2:
        JNZ     ??CommonApp_MessageMSGCB_1
        ; Setup parameters for call to function rs485_state
        MOV     R4,?V0 + 2
        MOV     R5,#0x0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   ??rs485_state?relay
//  163 }
??CommonApp_MessageMSGCB_1:
        MOV     A,#0x8
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 15)
        MOV     R7,#0x7
        LJMP    ?BANKED_LEAVE_XDATA
        CFI EndBlock cfiBlock2

        RSEG BANKED_CODE:CODE:NOROOT(0)
?Subroutine1:
        CFI Block cfiCond3 Using cfiCommon0
        CFI NoFunction
        CFI Conditional ??CrossCallReturnLabel_0
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 23)
        CFI Block cfiCond4 Using cfiCommon0
        CFI (cfiCond4) NoFunction
        CFI (cfiCond4) Conditional ??CrossCallReturnLabel_1
        CFI (cfiCond4) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
        CFI (cfiCond4) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI (cfiCond4) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI (cfiCond4) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI (cfiCond4) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI (cfiCond4) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI (cfiCond4) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI (cfiCond4) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI (cfiCond4) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI (cfiCond4) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI (cfiCond4) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI (cfiCond4) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI (cfiCond4) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI (cfiCond4) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI (cfiCond4) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI (cfiCond4) CFA_SP SP+0
        CFI (cfiCond4) CFA_XSP16 add(XSP16, 23)
        CFI Block cfiCond5 Using cfiCommon0
        CFI (cfiCond5) NoFunction
        CFI (cfiCond5) Conditional ??CrossCallReturnLabel_2
        CFI (cfiCond5) R6 load(1, XDATA, add(CFA_XSP16, literal(-15)))
        CFI (cfiCond5) VB load(1, XDATA, add(CFA_XSP16, literal(-14)))
        CFI (cfiCond5) V0 load(1, XDATA, add(CFA_XSP16, literal(-13)))
        CFI (cfiCond5) V1 load(1, XDATA, add(CFA_XSP16, literal(-12)))
        CFI (cfiCond5) V2 load(1, XDATA, add(CFA_XSP16, literal(-11)))
        CFI (cfiCond5) V3 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI (cfiCond5) V4 load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI (cfiCond5) V5 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI (cfiCond5) V6 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI (cfiCond5) R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI (cfiCond5) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI (cfiCond5) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI (cfiCond5) ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI (cfiCond5) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI (cfiCond5) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI (cfiCond5) CFA_SP SP+0
        CFI (cfiCond5) CFA_XSP16 add(XSP16, 23)
        CFI Block cfiPicker6 Using cfiCommon1
        CFI (cfiPicker6) NoFunction
        CFI (cfiPicker6) Picker
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     DPTR,#Address_dev
        MOVX    A,@DPTR
        XRL     A,R0
        RET
        CFI EndBlock cfiCond3
        CFI EndBlock cfiCond4
        CFI EndBlock cfiCond5
        CFI EndBlock cfiPicker6
//  164 
//  165 #ifdef RS485_DEV
//  166 void RS485_Analysis(uint8 *data, uint16 length)
//  167 {
//  168   RS485DR_t  rs485_rsData;
//  169   uint8 len=length;
//  170  
//  171   osal_memcpy(rs485_rsData.data_buf,data,length);
//  172   if(crc_confirm(data,length))
//  173   {
//  174     //判断是否是该设备命令
//  175   switch(rs485_rsData.data_core.cmdId[0])
//  176     {
//  177      case CT_CMD_CX:
//  178       //查询状态 0x03
//  179        if(rs485_rsData.data_core.head[0]==Address_dev)
//  180        {
//  181        rs485_state(rs485_rsData.data_buf,len);
//  182        }
//  183       break;
//  184     case CT_CMD_KZ:
//  185       //控制设备 0x04
//  186       if(rs485_rsData.data_core.head[0]==Address_dev)
//  187       {
//  188        rs485_control(rs485_rsData.data_buf,len);
//  189       }
//  190       break;
//  191     case CT_CMD_XG:
//  192       //修改地址 0x06
//  193       if(rs485_rsData.data_core.head[0]==Address_dev)
//  194       {
//  195        rs485_changeAddr(rs485_rsData.data_buf,len);
//  196       }
//  197       break;
//  198     case CT_CMD_DI:
//  199       //查询地址 0x25
//  200       rs485_address();
//  201       break;
//  202     } 
//  203   }
//  204 }
//  205 #endif
//  206 
//  207 void Data_Analysis(uint8 *data, uint16 length)
//  208 {
//  209   DE_t *mdeFrame;
//  210 
//  211   uint8 buf[FRAME_DATA_SIZE] = {0};
//  212   uint8 len = 0;
//  213   
//  214   //uint8 rslength=length;
//  215   //sprintf(buf, "data:%s, len:%d\n", data, length);
//  216   //CommonApp_GetDevDataSend(&rslength, 1);
//  217   
//  218   
//  219   mdeFrame = (DE_t *)SSAFrame_Analysis(HEAD_DE, data, length);
//  220 
//  221   //处理控制命令
//  222   if(mdeFrame)
//  223   {
//  224 //#ifdef __DEBUG__
//  225     //HalUARTWrite(SERIAL_COM_PORT, data, length);
//  226 //#endif
//  227 
//  228     if(!memcmp(mdeFrame->cmd, FR_CMD_BROCAST_REFRESH, 4)
//  229        || !memcmp(mdeFrame->cmd, FR_CMD_SINGLE_REFRESH, 4))
//  230     {
//  231       UO_t mFrame;
//  232 			
//  233       memcpy(mFrame.head, FR_HEAD_UO, 3);
//  234 #ifdef RTR_NWK
//  235       mFrame.type = FR_DEV_ROUTER;
//  236 #else
//  237       mFrame.type = FR_DEV_ENDDEV;
//  238 #endif
//  239       memcpy(mFrame.ed_type, FR_APP_DEV, 2);
//  240       memcpy(mFrame.short_addr, SHORT_ADDR_G, 4);
//  241       memcpy(mFrame.ext_addr, EXT_ADDR_G, 16);
//  242       mFrame.data = buf;
//  243       CommonDevice_GetData(mFrame.data, &mFrame.data_len);
//  244       memcpy(mFrame.tail, f_tail, 4);
//  245 
//  246       if(!SSAFrame_Package(HEAD_UO, &mFrame, &fBuf, &fLen))
//  247       {
//  248         CommonApp_SendTheMessage(COORDINATOR_ADDR, fBuf, fLen);
//  249       }
//  250     }
//  251     else if(!memcmp(mdeFrame->cmd, FR_CMD_SINGLE_EXCUTE, 4))
//  252     {
//  253       DataCmd_Ctrl(mdeFrame->data, mdeFrame->data_len);
//  254 
//  255       if(!CommonDevice_GetData(buf, &len))
//  256         Update_Refresh(buf, len);
//  257     }
//  258     else if(!memcmp(mdeFrame->cmd, FR_CMD_PEROID_EXCUTE, 4))
//  259     {
//  260       DataCmd_Ctrl(mdeFrame->data, mdeFrame->data_len);
//  261 
//  262 	  if(!CommonDevice_GetData(buf, &len))
//  263         Update_Refresh(buf, len);
//  264 	  
//  265       update_user_event(CommonApp_TaskID, CMD_PEROID_EVT, CommonApp_CmdPeroidCB, 
//  266 	  	CMD_PEROID_TIMEOUT, TIMER_LOOP_EXECUTION|TIMER_EVENT_RESIDENTS, NULL);
//  267     }
//  268     else if(!memcmp(mdeFrame->cmd, FR_CMD_PEROID_STOP, 4))
//  269     {
//  270       update_user_event(CommonApp_TaskID, CMD_PEROID_EVT, 
//  271 	  	NULL, TIMER_NO_LIMIT, TIMER_CLEAR_EXECUTION, NULL);
//  272 			
//  273       Update_Refresh(mdeFrame->data, mdeFrame->data_len);
//  274     }
//  275 #ifdef RTR_NWK
//  276     else if(!memcmp(mdeFrame->cmd, FR_CMD_JOIN_CTRL, 4))
//  277     {
//  278       if(!memcmp(mdeFrame->short_addr, SHORT_ADDR_G, 4))
//  279       {
//  280         uint8 cmdData, ret;
//  281         uint8 retData[2] = {0};
//  282 			
//  283         cmdData = atox(mdeFrame->data, mdeFrame->data_len);
//  284 
//  285         if(!cmdData)
//  286           ret = !CommonApp_PermitJoiningRequest(PERMIT_JOIN_FORBID);
//  287         else if(cmdData == 1)
//  288           ret = !CommonApp_PermitJoiningRequest(PERMIT_JOIN_TIMEOUT);
//  289 
//  290         incode_2_to_16(retData, &ret, 1);
//  291         PermitJoin_Refresh(retData, 2);
//  292       }
//  293     }
//  294 #endif
//  295   }
//  296 }
//  297 
//  298 
//  299 /*********************************************************************
//  300  * @fn      CommonApp_ProcessZDOStates
//  301  *
//  302  * @brief   Process when network change
//  303  *
//  304  * @param   network status
//  305  *
//  306  * @return  none
//  307  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  308 void CommonApp_ProcessZDOStates(devStates_t status)
CommonApp_ProcessZDOStates:
        CFI Block cfiBlock7 Using cfiCommon0
        CFI Function CommonApp_ProcessZDOStates
        CODE
//  309 {
        FUNCALL CommonApp_ProcessZDOStates, NLME_GetShortAddr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_ProcessZDOStates, RS485_HeartBeatCB
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_ProcessZDOStates, set_user_event
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_ProcessZDOStates, HalStatesInit
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 0
        MOV     A,R1
        MOV     R6,A
//  310 #ifndef RS485_DEV
//  311   UO_t mFrame;
//  312   uint8 buf[FRAME_DATA_SIZE] = {0};
//  313   
//  314   if( status == DEV_ROUTER || status == DEV_END_DEVICE)
//  315   {
//  316     nwkAddr = NLME_GetShortAddr();
//  317     incode_2_to_16(SHORT_ADDR_G, (uint8 *)&nwkAddr, 2);
//  318     memcpy(macAddr, NLME_GetExtAddr(), sizeof(ZLongAddr_t));
//  319     incode_2_to_16(EXT_ADDR_G, macAddr, 8);
//  320 
//  321     memcpy(mFrame.head, FR_HEAD_UO, 3);
//  322 #ifdef RTR_NWK
//  323     mFrame.type = FR_DEV_ROUTER;
//  324 #else
//  325     mFrame.type = FR_DEV_ENDDEV;
//  326 #endif
//  327     memcpy(mFrame.ed_type, FR_APP_DEV, 2);
//  328     memcpy(mFrame.short_addr, SHORT_ADDR_G, 4);
//  329     memcpy(mFrame.ext_addr, EXT_ADDR_G, 16);
//  330     mFrame.data = buf;
//  331     CommonDevice_GetData(mFrame.data, &mFrame.data_len);
//  332     memcpy(mFrame.tail, f_tail, 4);
//  333 
//  334     if(!SSAFrame_Package(HEAD_UO, &mFrame, &fBuf, &fLen))
//  335     {
//  336       CommonApp_SendTheMessage(0x0000, fBuf, fLen);
//  337     }
//  338 
//  339 	EndNodeApp_HeartBeatEvent();
//  340 	HalStatesInit(status);
//  341   }
//  342 #else
//  343   if( status == DEV_ROUTER || status == DEV_END_DEVICE)
        MOV     A,#0x7
        XRL     A,R6
        JZ      ??CommonApp_ProcessZDOStates_0
        MOV     A,#0x6
        XRL     A,R6
        JNZ     ??CommonApp_ProcessZDOStates_1
//  344   {
//  345         nwkAddr = NLME_GetShortAddr();
??CommonApp_ProcessZDOStates_0:
        ; Setup parameters for call to function NLME_GetShortAddr
        LCALL   ??NLME_GetShortAddr?relay
        MOV     DPTR,#nwkAddr
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        MOVX    @DPTR,A
//  346         //正常字节序，高位在前，低位在后.上电发送设备地址
//  347         //设置心跳事件
//  348         EndNodeApp_HeartBeatEvent();
        ; Setup parameters for call to function RS485_HeartBeatCB
        CLR     A
        MOV     ?V0 + 0,A
        MOV     ?V0 + 1,A
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 12)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x0
        MOV     R3,#0x0
        LCALL   ??RS485_HeartBeatCB?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 10)
        ; Setup parameters for call to function set_user_event
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 12)
        MOV     ?V0 + 0,#-0x1
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_ONE
        CFI CFA_XSP16 add(XSP16, 13)
        MOV     ?V0 + 0,#0x30
        MOV     ?V0 + 1,#0x75
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 15)
        MOV     R4,#??RS485_HeartBeatCB?relay & 0xff
        MOV     R5,#(??RS485_HeartBeatCB?relay >> 8) & 0xff
        MOV     R2,#0x1
        MOV     R3,#0x0
        MOV     DPTR,#CommonApp_TaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??set_user_event?relay
        MOV     A,#0x5
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 10)
//  349         HalStatesInit(status);
        ; Setup parameters for call to function HalStatesInit
        MOV     A,R6
        MOV     R1,A
        LCALL   ??HalStatesInit?relay
//  350   }
//  351 #endif
//  352 }
??CommonApp_ProcessZDOStates_1:
        LJMP    ?Subroutine0 & 0xFFFF
        CFI EndBlock cfiBlock7
//  353 
//  354 #ifndef HAL_KEY_LONG_SHORT_DISTINGUISH

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  355 void CommonApp_HandleCombineKeys(uint16 keys, uint8 keyCounts)
CommonApp_HandleCombineKeys:
        CFI Block cfiBlock8 Using cfiCommon0
        CFI Function CommonApp_HandleCombineKeys
        CODE
//  356 {
        FUNCALL CommonApp_HandleCombineKeys, HalLedBlink
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_HandleCombineKeys, osal_nv_item_init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 13, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 13, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_HandleCombineKeys, osal_nv_write
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_HandleCombineKeys, zgWriteStartupOptions
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_HandleCombineKeys, ZDOInitDevice
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_HandleCombineKeys, CommonApp_PermitJoiningRequest
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL CommonApp_HandleCombineKeys, CommonApp_PermitJoiningRequest
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
        CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
        CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
        CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
        CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
        CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
        CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
        CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
        CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
        CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
        CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
        CFI CFA_SP SP+0
        CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 1
        MOV     A,#-0x1
        LCALL   ?ALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 11)
        MOV     A,R1
        MOV     R6,A
//  357   if(keys & HAL_KEY_SW_6)
        MOV     A,R2
        ANL     A,#0x20
        JNZ     $+5
        LJMP    ??CommonApp_HandleCombineKeys_0 & 0xFFFF
//  358   {
//  359   	switch( keyCounts)
        MOV     A,R6
        JZ      ??CommonApp_HandleCombineKeys_1
        ADD     A,#-0x3
        JZ      ??CommonApp_HandleCombineKeys_2
        LJMP    ??CommonApp_HandleCombineKeys_0 & 0xFFFF
//  360   	{
//  361   	case 0:	//长按事件
//  362 #if defined(HOLD_INIT_AUTHENTICATION)
//  363       if(devState != DEV_HOLD)
??CommonApp_HandleCombineKeys_1:
        MOV     DPTR,#devState
        MOVX    A,@DPTR
        JNZ     $+5
        LJMP    ??CommonApp_HandleCombineKeys_0 & 0xFFFF
//  364       {
//  365       	HalLedBlink ( HAL_LED_4, 0, 50, 100 );
        ; Setup parameters for call to function HalLedBlink
        MOV     R4,#0x64
        MOV     R5,#0x0
        MOV     R3,#0x32
        MOV     R2,#0x0
        MOV     R1,#0x8
        LCALL   ??HalLedBlink?relay
//  366       	devStates_t tStates;
//  367 
//  368 #if (DEVICE_TYPE_ID==14) || (DEVICE_TYPE_ID==0xF0)
//  369 		SetThresHold(AIRCONTROL_PM25_THRESMODE_UP, AIRCONTROL_PM25_DEFAULT_TRESHOLD);
//  370 #endif
//  371 		
//  372       	if (ZSUCCESS == osal_nv_item_init( 
//  373                                         ZCD_NV_NWK_HOLD_STARTUP, sizeof(tStates),  &tStates))
        ; Setup parameters for call to function osal_nv_item_init
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 13)
        MOV     R4,#0x1
        MOV     R5,#0x0
        MOV     R2,#0x11
        MOV     R3,#0x4
        LCALL   ??osal_nv_item_init?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 11)
        MOV     A,R1
        JNZ     ??CommonApp_HandleCombineKeys_3
//  374       	{
//  375           tStates = DEV_HOLD;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        CLR     A
        MOVX    @DPTR,A
//  376           osal_nv_write(ZCD_NV_NWK_HOLD_STARTUP, 0, sizeof(tStates),  &tStates);
        ; Setup parameters for call to function osal_nv_write
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 13)
        MOV     ?V0 + 0,#0x1
        MOV     ?V0 + 1,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
        CFI CFA_XSP16 add(XSP16, 15)
        MOV     R4,#0x0
        MOV     R5,#0x0
        MOV     R2,#0x11
        MOV     R3,#0x4
        LCALL   ??osal_nv_write?relay
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 11)
//  377       	}
//  378 
//  379       	zgWriteStartupOptions(ZG_STARTUP_SET, ZCD_STARTOPT_DEFAULT_NETWORK_STATE);
??CommonApp_HandleCombineKeys_3:
        ; Setup parameters for call to function zgWriteStartupOptions
        MOV     R2,#0x2
        MOV     R1,#-0x1
        LCALL   ??zgWriteStartupOptions?relay
//  380       	WatchDogEnable( WDTIMX );
        MOV     0xc9,#-0x58
        MOV     0xc9,#0x58
        SJMP    ??CommonApp_HandleCombineKeys_0
//  381       }
//  382 #endif
//  383       break;
//  384 	
//  385     case 3:
//  386       //转发器允许/禁止入网,入网认证
//  387       if(devState == DEV_HOLD)
??CommonApp_HandleCombineKeys_2:
        MOV     DPTR,#devState
        MOVX    A,@DPTR
        JNZ     ??CommonApp_HandleCombineKeys_4
//  388       {
//  389         ZDOInitDevice( 0 );
        ; Setup parameters for call to function ZDOInitDevice
        MOV     R2,#0x0
        MOV     R3,#0x0
        LCALL   ??ZDOInitDevice?relay
        SJMP    ??CommonApp_HandleCombineKeys_0
//  390       }
//  391       else
//  392       {
//  393         if(isPermitJoining)
??CommonApp_HandleCombineKeys_4:
        MOV     DPTR,#isPermitJoining
        MOVX    A,@DPTR
        JZ      ??CommonApp_HandleCombineKeys_5
//  394         {
//  395           CommonApp_PermitJoiningRequest(PERMIT_JOIN_FORBID);
        ; Setup parameters for call to function CommonApp_PermitJoiningRequest
        MOV     R1,#0x0
        SJMP    ??CommonApp_HandleCombineKeys_6
//  396         }
//  397         else
//  398         {
//  399           CommonApp_PermitJoiningRequest(PERMIT_JOIN_TIMEOUT);
??CommonApp_HandleCombineKeys_5:
        ; Setup parameters for call to function CommonApp_PermitJoiningRequest
        MOV     R1,#0x1e
??CommonApp_HandleCombineKeys_6:
        LCALL   ??CommonApp_PermitJoiningRequest?relay
//  400         }
//  401       }
//  402       break;
//  403 
//  404     default: break;
//  405     }
//  406   }
//  407 
//  408 #ifdef KEY_PUSH_PORT_1_BUTTON
//  409   DeviceCtrl_HandlePort1Keys(keys, keyCounts);
//  410 #endif
//  411 }
??CommonApp_HandleCombineKeys_0:
        MOV     A,#0x1
        LCALL   ?DEALLOC_XSTACK8
        CFI CFA_XSP16 add(XSP16, 10)
        LJMP    ?Subroutine0 & 0xFFFF
        CFI EndBlock cfiBlock8
        REQUIRE WDCTL

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??CommonApp_InitConfirm?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    CommonApp_InitConfirm

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??CommonApp_MessageMSGCB?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    CommonApp_MessageMSGCB

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??CommonApp_ProcessZDOStates?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    CommonApp_ProcessZDOStates

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??CommonApp_HandleCombineKeys?relay:
        LCALL   ?BDISPATCH
        DATA
        DC24    CommonApp_HandleCombineKeys

        END
//  412 #else
//  413 void CommonApp_HandleCombineKeys(uint16 keys, uint8 keyCounts)
//  414 {
//  415   uint8 *keysID = get_keys_id();
//  416   uint8 *keysPush = get_keys_push();
//  417 
//  418   if (keysPush[0] == HAL_KEY_LONG_PUSH)
//  419   {
//  420 	if(keyCounts == 6 &&(osal_memcmp(keysID, "333333", keyCounts)
//  421 		|| osal_memcmp(keysID, "444444", keyCounts)
//  422 		|| osal_memcmp(keysID, "555555", keyCounts)))
//  423     { 
//  424 #if defined(HOLD_INIT_AUTHENTICATION)
//  425       if(devState != DEV_HOLD)
//  426       {
//  427       	HalLedBlink ( HAL_LED_4, 0, 50, 100 );
//  428         devStates_t tStates;
//  429         if (ZSUCCESS == osal_nv_item_init( 
//  430                   ZCD_NV_NWK_HOLD_STARTUP, sizeof(tStates),  &tStates))
//  431         {
//  432            tStates = DEV_HOLD;
//  433           osal_nv_write(
//  434                 ZCD_NV_NWK_HOLD_STARTUP, 0, sizeof(tStates),  &tStates);
//  435         }
//  436 
//  437         zgWriteStartupOptions(ZG_STARTUP_SET, ZCD_STARTOPT_DEFAULT_NETWORK_STATE);
//  438         WatchDogEnable( WDTIMX );
//  439       }
//  440 #endif
//  441     }
//  442 	else if((keysID[0]=='3' || keysID[0]=='4' || keysID[0]=='5')
//  443 		&& keyCounts == 1)
//  444     {
//  445       //转发器允许/禁止入网,入网认证
//  446       if(devState == DEV_HOLD)
//  447       {
//  448         ZDOInitDevice( 0 );
//  449       }
//  450       else
//  451       {
//  452         if(isPermitJoining)
//  453         {
//  454           CommonApp_PermitJoiningRequest(PERMIT_JOIN_FORBID);
//  455         }
//  456         else
//  457         {
//  458           CommonApp_PermitJoiningRequest(PERMIT_JOIN_TIMEOUT);
//  459         }
//  460       }
//  461     }
//  462   }
//  463   else if (keysPush[0] == HAL_KEY_SHORT_PUSH)
//  464   {
//  465 #ifdef KEY_PUSH_PORT_1_BUTTON
//  466     DeviceCtrl_HandlePort1Keys(keys, keyCounts);
//  467 #endif
//  468   }
//  469 }
//  470 #endif
//  471 
//  472 void EndNodeApp_HeartBeatEvent(void)
//  473 {
//  474 #ifndef RS485_DEV
//  475   CommonApp_HeartBeatCB(NULL, NULL, NULL);
//  476 
//  477   set_user_event(CommonApp_TaskID, HEARTBERAT_EVT, CommonApp_HeartBeatCB, 
//  478   	HEARTBEAT_TIMEOUT, TIMER_LOOP_EXECUTION|TIMER_EVENT_RESIDENTS, NULL);
//  479 #else
//  480   RS485_HeartBeatCB(NULL, NULL, NULL);
//  481 
//  482   set_user_event(CommonApp_TaskID, HEARTBERAT_EVT, RS485_HeartBeatCB, 
//  483   	HEARTBEAT_TIMEOUT, TIMER_LOOP_EXECUTION|TIMER_EVENT_RESIDENTS, NULL);
//  484 #endif
//  485 }
//  486 
// 
// 606 bytes in segment BANKED_CODE
//  24 bytes in segment BANK_RELAYS
//   1 byte  in segment SFR_AN
// 
// 630 bytes of CODE memory
//   0 bytes of DATA memory (+ 1 byte shared)
//
//Errors: none
//Warnings: 1
